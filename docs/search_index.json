[["index.html", "Applied Time Series Analysis Preface", " Applied Time Series Analysis Vipul Bhatt 2024-01-15 Preface These lecture notes are prepared for an upper level undergraduate course in time series econometrics. Every fall I teach a course on applied time series analysis at James Madison University. These notes borrow heavily from the teaching material that I have developed over several years of instruction of this course. One of my main objective is to develop a primer on time series analysis that is more accessible to undergraduate students than standard textbooks available in the market. Most of these textbooks in my opinion are densely written and assume advanced mathematical skills on the part of our students. Further, I have also struggled with their topic selection and organization. Often I end up not following the chapters in order and modify content (by adding or subtracting) to meet my students needs. Such changes causes confusion for some students and more importantly discourages optimal use of the textbook. Hence, this is an undertaking to develop a primer on time series that is accessible, follows a more logical sequencing of topics, and covers content that is most useful for undergraduate students in business and economics. Note: These notes have been prepared by me using various sources, published and unpublished. All errors that remain are mine. "],["intro.html", "Chapter 1 Introduction to Forecasting 1.1 Time Series 1.2 Serial Correlation 1.3 Testing for Serial Correlion 1.4 White Noise Process 1.5 Important Elements of Forecasting 1.6 Loss Function and Optimal Forecast", " Chapter 1 Introduction to Forecasting 1.1 Time Series A time series is a specific kind of data where observations of a variable are recorded over time. For example, the data for the U.S. GDP for the last 30 years is a time series data. Such data shows how a variable is changing over time. Depending on the variable of interest we can have data measured at different frequencies. Some commonly used frequencies are intra-day, daily, weekly, monthly, quarterly, semi-annual and annual. Figure 1.1 below plots data for quarterly and monthly frequency. Figure 1.1: Time Series at quarterly and monthly frequency The first panel shows data for the real gross domestic product (GDP) for the US in billions of 2012 dollars, measured at a quarterly frequency. The second panel shows data for the advance retail sales (millions of dollars), measured at monthly frequency. Formally, we denote a time series variable by \\(y_t\\), where \\(t=0,1,2,..,T\\) is the observation index. For example, at \\(t=10\\) we get the tenth observation of this time series, \\(y_{10}\\). 1.2 Serial Correlation Serial correlation (or auto correlation) refers to the tendency of observations of a time series being correlated over time. It is a measure of the temporal dynamics of a time series and addresses the following question: what is the effect of past realizations of a time series on the current period value? Formally, \\[\\begin{equation} \\rho(s)=Cor(y_t, y_{t-s}) =\\frac{ Cov(y_t,y_{t-s})}{\\sqrt{\\sigma^2_{y_t} \\times \\sigma^2_{y_{t-s}}}} \\tag{1.1} \\end{equation}\\] where \\(Cov(y_t,y_{t-s})= E(y_t-\\mu_{y_t})(y_{t-s}-\\mu_{y_{t-s}})\\) and \\(\\sigma^2_{y_t}=E(y_t-\\mu_{y_t})^2\\) Here, \\(\\rho(s)\\) is the serial correlation of order \\(s\\). For example, \\(s=1\\) implies first order serial correlation between \\(y_t\\) and \\(y_{t-1}\\), \\(s=2\\) implies second order serial correlation between \\(y_t\\) and \\(y_{t-2}\\), and so on. Note that often we use historical data to forecast. If there is no serial correlation, then past can offer no guidance for the present and future. In that sense, presence of serial correlation of some order is the first condition for being able to forecast a time series using its historical realizations. Now, we can either have positive or negative serial correlation in data. Figure ?? plots two time series with positive and negative serial correlation, respectively. Figure 1.2: Serial Correlation Figure 1.3: Serial Correlation 1.3 Testing for Serial Correlion We can use a Lagrange-Multiplier (LM) test for detecting serial correlation. This test is also known as Breuch-Godfrey test. I will use the linear regression model to explain this test. Consider the following regression model: \\[\\begin{equation} y_t=\\beta_0 + \\beta_1 X_{1t}+\\epsilon_t \\end{equation}\\] Consider the following model for serial correlation of order p for the error term: \\[\\begin{equation} \\epsilon_t=\\rho_1 \\epsilon_{t-1}+\\rho_2 \\epsilon_{t-2}+...+ \\rho_p \\epsilon_{t-p}+\\nu_t \\tag{1.2} \\end{equation}\\] Then we are interested in the following test: \\[H_0=\\rho_1=\\rho_2=...=\\rho_p=0 \\] \\[H_A = Not \\ H_0 \\] To implement this test, we estimate the BG regression model given by: \\[\\begin{equation} e_t=\\alpha_0 + \\alpha_1 X_{1t}+ \\rho_1 e_{t-1}+\\rho_2 e_{t-2}+...+ \\rho_p e_{t-p}+\\nu_t \\tag{1.3} \\end{equation}\\] where we replace the error term with the OLS residuals (denoted by \\(e\\)). The LM test statistic is given by: \\[ LM = N\\times R^2_{BG} \\sim \\chi^2_p \\] If the test statistic value is greater than the critical value then we reject the null hypothesis. 1.4 White Noise Process Definition 1.1 (White Noise) A time series is a white noise process if it has zero mean, constant and finite variance, and is serially uncorrelated. Formally, \\(y_t\\) is a white noise process if: \\(E(y_t)=0\\) \\(Var(y_t)=\\sigma^2_y\\) \\(Cov(y_t,y_{t-s})= 0 \\forall s\\neq t\\) We can compress the above definition as: \\(y_t\\sim WN(0,\\sigma^2_y)\\). Often we assume that the unexplained part of a time series follows a white noise process. Formally, \\[\\begin{equation} Time \\ Series \\ = \\ Explained \\ + \\ White \\ Noise \\end{equation}\\] By definition we cannot forecast a white noise process. An important diagnostics of model adequacy is to test whether the estimated residuals are white noise (more on this later). 1.5 Important Elements of Forecasting Definition 1.2 (Forecast) A forecast is an informed guess about the unknown future value of a time series of interest. For example, what is the stock price of Facebook next Monday? There are three possible types of forecasts: Density Forecast: we forecast the entire probability distribution of the possible future value of the time series of interest. Hence, \\[\\begin{equation} F(a)=P[y_{t+1}\\leq a] \\end{equation}\\] give us the probability that the 1-period ahead future value of \\(y_{t+1}\\) will be less than or equal to \\(a\\). For example, the future real GDP growth could be normally distributed with a mean of 1.3% and a standard deviation of 1.83%. Figure 1.4 below plots the density forecast for real GDP growth. Figure 1.4: Density Forecast for Future Real GDP Growth Point Forecast: our forecast at each horizon is a single number. Often we use the expected value or mean as the point forecast. For example, the point forecast for the 1-period ahead real GDP growth can be the mean of the probability distribution of the future real GDP growth: \\[\\begin{equation} f_{t,1}=1.3% \\end{equation}\\] Interval Forecast: our forecast at each horizon is a range which is obtained by adding margin of errors to the point forecast. With some probability we expect our future value to fall withing this range. For example, the 95% interval forecast for the next period real GDP growth is (-2.36%,4.96%). Hence, with 95% confidence we expect next period GDP to fall between -2.36% and 4.96%. Definition 1.3 (Forecast Horizon) Forecast Horizon is the number of periods into the future for which we forecast a time series. We will denote it by \\(h\\). Hence, for \\(h=1\\), we are looking at 1-period ahead forecast, for \\(h=2\\) we are looking at 2-period ahead forecast and so on. Formally, for a given time series \\(y_t\\), the h-period ahead unknown value is denoted by \\(y_{t+h}\\). The forecast of this value is denoted \\(f_{t,h}\\). Figure 1.5: Forecast Horizon Definition 1.4 (Forecast Error) A forecast error is the difference between the realization of the future value and the previously made forecast. Formally, the \\(h\\)-period ahead forecast error is given by: \\[\\begin{equation} e_{t,h}=y_{t+h}-f_{t,h} \\end{equation}\\] Hence, for every horizon, we will have a forecast and a corresponding forecast error. These errors can be negative (indicating over prediction) or positive (indicating under prediction). Forecasts are based on information available at the time of making the forecast. Information Set contains all the relevant information about the time series we would like to forecast. We denote the set of information available at time \\(T\\) by \\(\\Omega_T\\). There are two types of information sets: Univariate Information set: Only includes historical data on the time series of interest: \\[\\begin{equation} \\Omega_T=\\{y_T, y_{T-1}, y_{T-2}, ...., y_1\\} \\end{equation}\\] Multivariate Information set: Includes historical data on the time series of interest as well as any other variable(s) of interest. For example, suppose we have one more variable \\(x\\) that is relevant for forecasting \\(y\\). Then: \\[\\begin{equation} \\Omega_T=\\{y_T, x_T, y_{T-1}, x_{T-1}, y_{T-2},x_{T-2}. ...., y_1, x_1\\} \\end{equation}\\] 1.6 Loss Function and Optimal Forecast Think of a forecast as a solution to an optimization problem. When forecasts are wrong, the person making the forecast will suffer some loss. This loss will be a function of the magnitude as well as the sign of the forecast error. Hence, we can think of an optimal forecast as a solution to a minimization problem where the forecaster is minimizing the loss from the forecast error. Definition 1.5 (Loss Function) A loss function is a mapping between forecast errors and their associated losses. Formally, we denote the h-period ahead loss function by \\(L(e_{t,h})\\). For a function to be used as a loss function, three properties must be satisfied: \\(L(0)=0\\) \\(\\frac{dL}{de}&gt;0\\) \\(L(e)\\) is a continuous function. Two types of loss functions are: Symmetric Loss Function: both positive and negative forecast errors lead to same loss. See Figure 1.6. A commonly used loss function is quadratic loss function given by: \\[\\begin{equation} L(e_{t,h})=e_{t,h}^2 = (y_{t+h}-f{t,h})^2 \\end{equation}\\] Figure 1.6: Quadratic Loss Functions Asymmetric Loss Function: loss depends on the sign of the forecast error. For example, it could be that positive errors produce greater loss when compared to negative errors. See the function below and Figure 1.7 that attaches a higher loss to positive errors: \\[\\begin{equation} L(e_{t,h})=e_{t,h}^2+4 \\times e_{t,h} \\end{equation}\\] Figure 1.7: Asymmetric Loss Function Once we have chosen our loss function, the optimal forecast can be obtained by minimizing the expected loss function. An optimal forecast minimizes the expected loss from the forecast, given the information available at the time. Mathematically, we denote it by \\(f^*_{t,h}\\) and it solves the following minimization problem: \\[\\begin{equation} min_{f_{t,h}} E(L(e_{t,h})|\\Omega_t) \\end{equation}\\] In theory we can assume any functional form for the loss function and that will lead to a different optimal forecast. An important result that follows from a specific functional form is stated as Theorem 1.1. Theorem 1.1 If the loss function is quadtratic then the optimal forecast is the conditional mean of the time series of interest. Formally, if \\(L(e_{t,h})=e_{t,h}^2\\) then, \\[\\begin{equation} f^*_{t,h}=E(y_{t+h}|\\Omega_t) \\end{equation}\\] Note that \\(E(e_{t,h}^2)\\) is known as mean squared errors (MSE). Hence, the expected loss from a quadratic loss function is the same as the MSE. In this course, we assume that the forecaster faces a quadratic loss function and hence based on Theorem 1.1, we will learn different models for estimating the conditional mean of the future value of the time series of interest, i.e., \\(E(y_{t+h}|\\Omega_t)\\). "],["regression-based-forecasting.html", "Chapter 2 Regression-based Forecasting 2.1 Scenario Analysis and Conditional Forecasts 2.2 Unconditional Forecasts 2.3 Some practical issues", " Chapter 2 Regression-based Forecasting One way to compute the conditional expectation is the linear regression model. Here, our information set contains data on all relevant explanatory variables available at the time of forecast, i.e, \\[\\begin{equation} \\Omega_t={X_{1t}, X_{2t},...X_{Kt}} \\end{equation}\\] Hence, we get the following equality: \\[\\begin{equation} E(y_t|\\Omega_t)=E(y_{t}|X_{1t}, X_{2t}, X_{3t},...,X_{Kt}) \\end{equation}\\] The right hand side of the above equation is the multiple regression model of the form: \\[\\begin{equation} y_{t}=\\beta_0+\\beta_1 X_{1t}+\\beta_2 X_{2t}+..+\\beta_K X_{Kt}+\\epsilon_t \\end{equation}\\] We can easily estimate the above model using Ordinary Least Squares (OLS) and compute the predicted value of \\(y\\): \\[\\begin{equation} \\widehat{y}_t = \\widehat{\\beta_0} +\\widehat{\\beta_1} X_{1t} +\\widehat{\\beta_2} X_{2t}+...+ \\widehat{\\beta_k} X_{Kt} \\end{equation}\\] The above equation can be used to compute the optimal forecast. Suppose, we are interested in computed the \\(h\\) period ahead forecast for \\(y\\). Then, using the above equation we get: \\[\\begin{equation} \\widehat{y}_{t+h} = \\widehat{\\beta_0} +\\widehat{\\beta_1} X_{1t+h} +\\widehat{\\beta_2} X_{2t+h}+...+ \\widehat{\\beta_k} X_{Kt+h} \\end{equation}\\] 2.1 Scenario Analysis and Conditional Forecasts One way to use a regression model to produce forecasts is called scenario analysis where we produce a different forecast for the dependent variable under each possible scenario about the future values of the independent variables. For example, what will be the forecast for inflation if the Federal Reserve Bank raises the interest rate? Would our forecast differ depending on the size of the increase in the interest rate? 2.2 Unconditional Forecasts An alternative is to separately forecast each independent variable and then compute the forecast for the dependent variable. Yet another alternative is to use lagged variables as independent variables. Depending on the number of lags, we can forecast that much ahead into future (see Distributed Lag Section for details). 2.3 Some practical issues To forecast the dependent variable we first need to compute a forecast for the independent variable. Errors in this step induce errors later. Spurious regression: It is quite possible to find a strong linear relationship between two completely unrelated variables over time if they share a common time trend. Model Uncertainty: We do not know the true functional form for the regression model and hence our estimated model is only a proxy for the true model. Parameter Uncertainty: This kind of forecast uses regression coefficients that are computed using a fixed sample. Over time with new data, there will be changes in these coefficients. "],["components-of-a-time-series.html", "Chapter 3 Components of a Time Series 3.1 Decomposing a time series 3.2 Uses of Decomposition of a time series", " Chapter 3 Components of a Time Series A given time series can have four possible components: Trend: denoted by \\(B_t\\) captures the long run behavior of the time series of interest. Season: denoted by \\(S_t\\) are periodic fluctuations over seasons. The period of the season is fixed and known. For example, rise in non-durable sales during Christmas. Cycle: denoted by \\(C_t\\) are non-periodic fluctuations in that they occur regularly but over periods that are not fixed in duration. Irregular: denoted by \\(\\epsilon_t\\) are random fluctuations, typically modeled as a white noise process. 3.1 Decomposing a time series We can decompose any given time series into its components. There are two ways to accomplish this: Additive Decomposition: Here it is assumed that all four components are added to obtain the underlying time series: \\[\\begin{equation} y_t= B_t+S_t+C_t +\\epsilon_t \\end{equation}\\] Multiplicative Decomposition: Here it is assumed that all four components are multiplied to obtain the underlying time series: \\[\\begin{equation} y_t= B_t \\times S_t \\times C_t \\times \\epsilon_t \\end{equation}\\] Note that using properties of logarithms, multiplicative decomposition is the same as additive decomposition in log terms: \\[\\begin{equation} log(y_t)= log(B_t) + log(S_t) + log(C_t) + log(\\epsilon_t) \\end{equation}\\] Most statistical software can implement these decomposition using data on a time series variable as input. Typically they combine cyclical component with irregular component and provide a three-way decomposition. In Figure 3.1 I use R to decompose real GDP for the US into its components. Figure 3.1: Additive Decomposition of Retail Sales 3.2 Uses of Decomposition of a time series The usefulness of decomposing a time series depends on our objective. It may be of interest to study each component separately or to simply improve our understanding of the temporal dynamics of a time series of interest. Decomposing it into different components is the first step towards achieving that goal. We can also use the decomposition to filter out components that we are not interested in studying. If for example we are only interested in modeling the cyclical component of the time series, then we can assume some kind decomposition, additive or multiplicative, and filter out the trend and seasonal component. For example, assuming additive decomposition, the filtered time series is given by: \\[\\begin{equation} Filtered \\ y_t= y_t-B_t-S_t \\end{equation}\\] We can then proceed to model the cyclical component using the filtered data. "],["smoothing-methods.html", "Chapter 4 Smoothing Methods 4.1 Moving Average Method 4.2 Simple Exponential Smoothing 4.3 Holt-Winters Smoothing 4.4 Holt-Winters Smoothing with Seasonality 4.5 Application", " Chapter 4 Smoothing Methods One way to approach forecasting is to average out the fluctuations in the underlying time series to produce a smoothed data which can be extrapolated to produce forecasts. These smoothing methods are essentially model-free and may not even produce optimal forecasts. Depending on the method used one can accommodate seasonal as well as trend components of the underlying time series. 4.1 Moving Average Method We compute an average of most recent data values for the time series and use it as a forecast for the next period. An important parameter is the window over which we take the average. Let us denote this window by \\(m\\), then: \\[\\begin{equation} y^s_{t+1}=\\frac{\\sum \\limits_{i=t-m+1}^{t}{y_i}}{m} \\end{equation}\\] A larger value of \\(m\\) produces greater smoothing and most software have a default value of this parameter which can be changed if needed. 4.2 Simple Exponential Smoothing In the moving average method, all observations received same weight. However, it is reasonable to argue that more recent observations may have a greater influence than those in the remote past. In this method, the weight attached to past observations exponentially decay over time. Here is the algorithm for computing the smoothed data and its forecast: Initialize at t=1: \\[y_1^s=y_1\\] Update: \\[y_{t}^{s}= \\alpha y_t + (1-\\alpha)y_{t-1}^{s} \\quad for \\ t=2,3,...T\\] 3: h-period ahead forecast: \\[f_{T,h}= y_T^s\\] Here the h-period ahead forecast is: Exercise: Can you show that \\(y_{t}^{s}\\) is a is the weighted moving average of all past observations? Use backward substitution method. Here \\(\\alpha \\in (0,1)\\) is the smoothing parameter, with smaller value indicating greater smoothing. 4.3 Holt-Winters Smoothing We add trend component to the simple exponential smoothing. In step 2 the equation we use to update the smoothed data is given by: \\[\\begin{align} y_{t}^{s}= \\alpha y_t + (1-\\alpha)(y_{t-1}^{s}+B_{t-1}) \\\\ \\nonumber B_t = \\beta (y_t^s -y_{t-1}^s) + (1-\\beta) B_{t-1} \\end{align}\\] We now have an additional parameter \\(\\beta\\) that is the trend parameter. Here the h-period ahead forecast is: \\[\\begin{align} f_{T,h} = y_T^s + h\\times B_T \\end{align}\\] 4.4 Holt-Winters Smoothing with Seasonality We now add seasonal component along with trend. Assuming multiplicative seasonality with period \\(n\\): \\[\\begin{align} y_{t}^{s}= \\alpha \\frac{y_t}{S_{t-n}} + (1-\\alpha)(y_{t-1}^{s}+B_{t-1})\\\\ B_t = \\beta (y_t^s -y_{t-1}^s) + (1-\\beta) B_{t-1}\\\\ S_t = \\gamma\\frac{y_t}{y_t^s}+(1-\\gamma)S_{t-n} \\end{align}\\] The h-period ahead forecast is given by: \\[\\begin{equation} f_{T,h}= (y_T^s + h\\times B_T) \\times S_{T+h-n} \\end{equation}\\] 4.5 Application We use R to implement a 12-period ahead forecast for new housing starts for the U.S. The data is at monthly frequency from Jan 1959 through March 2019. The resulting forecasts are plotted in Figure 4.1. Figure 4.1: Forecast of Housing Starts: Three Smoothing Methods "],["modeling-trend-and-seasonal-components.html", "Chapter 5 Modeling Trend and Seasonal Components 5.1 Trend Estimation 5.2 Seasonal Model", " Chapter 5 Modeling Trend and Seasonal Components 5.1 Trend Estimation An important component of a time series is trend that captures the long run evolution of the variable of interest. There are two types of trends: Deterministic Trend: the underlying trend component is a known function of time with unknown parameters. Stochastic Trend: the trend component is random. In this note we will focus on estimating and forecasting deterministic trend models. We will come back to stochastic trend later when we talk about stationarity property of a time series. 5.1.1 Parametrizing a deterministic trend Whether or not there is deterministic trend in the data can be typically gleaned by simply plotting the time series over time. For example, Figure @ref(fig: ch5-figure1) below plots real GDP for the US at quarterly frequency. We can observe a positive time trend with real GDP increasing with time. In this section we will learn to fit a function that captures this relationship accurately. Figure 5.1: Real GDP (2012 Chained Billions of Dollars) Note: The variable time is denoted by \\(t\\) and it is artificially created to take value of 1 for the first period, 2 for the second period and so on. There are two commonly used functional forms for capturing a deterministic trend: Polynomial Trend: We fit a polynomial of appropriate order to capture the time trend. For example, A. Linear trend: \\[\\begin{equation} y_t=\\beta_0 +\\beta_1 t +\\epsilon_t \\end{equation}\\] B. Quadratic trend: \\[\\begin{equation} y_t=\\beta_0 +\\beta_1 t + \\beta_2 t^2 +\\epsilon_t \\end{equation}\\] In general, we can fit a polynomial of order \\(q\\): \\[\\begin{equation} y_t=\\beta_0 + \\sum_{i=1}^q \\beta_i t^i +\\epsilon_t \\end{equation}\\] We can estimate this model using the OLS. One of the key component here is to determine the right order of the polynomial. We can begin with a large enough number for \\(q\\) and then select the appropriate order using AIC or BIC criterion. Exponential or log-linear trend: In some cases we may want to use an exponential trend or equivalently a log-linear trend. \\[\\begin{align} y_t=e^{(\\beta_0 +\\beta_1 t +\\epsilon_t)}\\\\ equivalently\\\\ log(y_t)=\\beta_0 +\\beta_1 t +\\epsilon_t \\end{align}\\] Again we can estimate the above model using OLS. 5.1.2 Uses of the Deterministic Trend Model Once we have finalized our deterministic trend model i.e., either a polynomial of a specific order or log-liner trend, we can use the estimated model for the following two purposes: Detrending our data: Suppose we would like to eliminate trend from our data. The residual from our final trend model is the detrended time series. Forecasting: We can also forecast our time series based on the estimated trend. For example, suppose our final model is a quadratic trend. The predicted value is given by: \\[\\begin{equation} \\widehat{y_t}=\\widehat{\\beta_0}+\\widehat{\\beta_1} t + \\widehat{\\beta_2} t^2 \\end{equation}\\] Then, the 1-period ahead forecast for \\(y_{t+1}\\) can be obtained by solving: \\[\\begin{equation} \\widehat{y_{t+1}}=\\widehat{\\beta_0}+\\widehat{\\beta_1} (t+1) + \\widehat{\\beta_2} (t+1)^2 \\end{equation}\\] 5.1.3 Application: Estimating a polynomial trend for U.S. Real GDP We will now fit a polynomial trend to the US real GDP data that was presented in Figure ??. We first estimate polynomials of different orders and select the optimal order determined by the lowest possible AIC/BIC. Table 5.1. shows these statistics for up to 4th order polynomial. We find that the lowest value occur at \\(q=4\\). Table 5.1: Optimal Order of the Polynomial order AIC BIC 1 5191.926 5203.107 2 4489.932 4504.840 3 4457.576 4476.210 4 4420.521 4442.882 Hence, our final trend model is: \\[\\begin{equation} y_t=\\beta_0 +\\beta_1 t + \\beta_2 t^2 + \\beta_3 t^3 + \\beta_4 t^4 +\\epsilon_t \\end{equation}\\] The estimated trend model is presented in Table 5.2. Table 5.2: Regression Results Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 2037.755 93.220 21.860 0.000 trend 30.795 4.179 7.368 0.000 I(trend^2) -0.087 0.055 -1.585 0.114 I(trend^3) 0.001 0.000 5.557 0.000 I(trend^4) 0.000 0.000 -6.401 0.000 Using the estimated model, we can compute the detrended data as the residual and also forecast \\(y_t\\). Figure 5.2 below plots the detrended real GDP obtained as a residual from our trend model. Figure 5.2: Detrended Real GDP Figure 5.3 shows the forecast of real GDP for next 8 quarters along with the 95% confidence bands. Figure 5.3: Forecast of Real GDP 5.2 Seasonal Model We now focus on the seasonal component of a time series, i.e., that is periodic fluctuations that repeat themselves every season. For example, increase in ice cream sales during summer season. Just like trend component, such seasonal pattern could be deterministic or stochastic. In this chapter we will focus on estimating deterministic seasonal component. In Figure 5.4 we plot housing starts in the U.S. The data is at monthly frequency and we can see a clear seasonal pattern. Housing starts seem to increase in spring and summer months. This is followed by a decline in fall and winter months. Figure 5.4: Housing Starts in U.S. One option to deal with seasonality is to obtain seasonally adjusted data (or deseasonalized data) from the source itself. Alternatively, we can use decomposition method and appropriately filter out the seasonal component. However, if our objective is to explicitly model the seasonal component of a time series then we must work with non-seasonally adjusted data. 5.2.1 Regression Model with Seasonal Dummy Variables One way to account for seasonal patterns in data is to add dummy variables for season. To avoid perfect multicollinearity, is there are \\(s\\) seasons, we can include \\(s-1\\) dummy variables. For example, for quarterly data, \\(s=4\\) and hence we need \\(s-1=3\\) dummy variables in our regression model. Formally, for quarterly data, the seasonal regression model is given by: \\[\\begin{equation} y_t= \\beta_0 + \\beta_1 D_{1t}+ \\beta_2 D_{2t} + \\beta_3 D_{3t} + \\epsilon_t \\end{equation}\\] In the above regression model, \\(D_1,D_2,\\) and \\(D_3\\) are dummy variables that capture first three quarters of the year. For example, \\(D_1=1\\) for the first quarter and \\(D_1=0\\) otherwise. Similarly, \\(D_2=1\\) for the second quarter and \\(D_2=0\\) otherwise. In this example, we use the fourth quarter as the base group. The above model can be estimated using OLS. Again, we can use the residual from our estimated model as a measure of deseasonlized data. We can also forecast the dependent variable based on the seasonal component only. 5.2.2 Application: Seasonal Model of Housing Starts We now estimate a seasonal regression model for the housing starts data presented in Figure 5.4. The data is at monthly frequency which implies we can have 12 possible seasons and hence would need 11 dummy variables in our regression model. Formally, we use January as the base group and include dummy variables for the last 11 months of the year: \\[\\begin{equation} y_t=\\beta_0 + \\sum_{i=2}^{12}\\beta_i D_{it} + \\epsilon_t \\end{equation}\\] Table 5.3 presents the estimation results for this exercise. In Figure 5.5 we plot the forecast of housing starts for next 12 months using our estimated model, along with 95% confidence bands. Table 5.3: Regression Results Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 88.452 4.082 21.671 0.000 season2 2.695 5.772 0.467 0.641 season3 30.888 5.772 5.351 0.000 season4 46.138 5.772 7.993 0.000 season5 51.317 5.772 8.890 0.000 season6 50.671 5.772 8.778 0.000 season7 45.163 5.772 7.824 0.000 season8 42.935 5.772 7.438 0.000 season9 36.583 5.772 6.338 0.000 season10 40.238 5.772 6.971 0.000 season11 20.245 5.772 3.507 0.000 season12 4.448 5.795 0.768 0.443 Figure 5.5: Forecast of Housing Starts "],["modeling-cycle.html", "Chapter 6 Modeling Cycle 6.1 Stationarity and Autocorrelation 6.2 Autoregressive (AR) Model 6.3 Estimating an AR model 6.4 Moving Average (MA) Model 6.5 ARMA(p, q) 6.6 Integrated ARMA or ARIMA(p,d,q) 6.7 Trend Stationary vs Difference Stationary Time Series 6.8 Testing for a unit root 6.9 Box-Jenkins Method for estimating ARIMA(p,d,q)", " Chapter 6 Modeling Cycle In this chapter we will focus on the cyclical component of a time series and hence focus on data that either has no trend and seasonal components, or data that is filtered to eliminate any trend and seasonality. One of the most commonly used method to model cyclicality is the Autogressive Moving Average (ARMA). This model has two distinct components: Autoregressive (AR) component: the current period value of a time series variable depends on its past (lagged) observations. We use \\(p\\) to denote the order of the AR component and is the number of lags of a variable that directly affect the current period value. For example, a firm’s production in the current period maybe impacted by past levels of production. If last year’s production exceeded demand, the stock of unsold goods may be used to meet this period demand first, hence lowering the current period production. Moving average (MA) component: the current period value of a time series variable depends on current period shock as well as past shocks to this variable. We use \\(q\\) to denote the order of the MA component and is the number of past period shocks that affect the current period value of the variable of interest. For example, if the Federal Reserve Bank raises the interest in 2016, the effects of that policy shock may impact investment and consumption spending in 2017. Before we consider these time series model in details it is useful to discuss certain properties of time series that allow us a better understanding of these models. 6.1 Stationarity and Autocorrelation 6.1.1 Covariance Stationary Time Series Definition 6.1 (Covariance Stationary Time Series) A time series \\(\\{y_t\\}\\) is said to be a covariance stationary process if: \\(E(y_t)=\\mu_y \\quad \\forall \\quad t\\) \\(Var(y_t)=\\sigma_y^2 \\quad \\forall \\quad t\\) \\(Cov(y_t,y_{t-s})=\\gamma(s) \\quad \\forall \\quad s\\neq t\\) One way to think about stationarity is mean-reversion, i.e, the tendency of a time series to return to its long-run unconditional mean following a shock (or a series of shock). Figure @(fig:ch6-figure1) below shows this property graphically. Figure 6.1: Reversion to mean Figure 6.2: Reversion to mean in practice In practice however, you will not be able to visualize a mean-reverting stationary process this clearly. For example, in Figure 6.2 we plot real GDP growth for the U.S. which is a stationary process with a mean of 0.7%. In this chapter we will only consider stationary time series data. Later on we will learn how to work with non-stationary data. 6.1.2 Correlation vs Autocorrelation In statistics, correlation is a measure of relationship between two variables. In the time series setting, we can think of the current period value and the past period value of a variable as two separate variables, and compute correlation between them. Such a correlation, between current and lagged observation of a time series is called serial correlation or autocorrelation. In general, for a time series, \\(\\{y_t\\}\\), the autocorrelation is given by: \\[\\begin{align} Cor(y_t,y_{t-s})=\\frac{ Cov(y_t,y_{t-s})}{\\sqrt{\\sigma^2_{y_t} \\times \\sigma^2_{y_{t-s}}}} \\end{align}\\] where \\(Cov(y_t,y_{t-s})= E(y_t-\\mu_{y_t})(y_{t-s}-\\mu_{y_{t-s}})\\) and \\(\\sigma^2_{y_t}=E(y_t-\\mu_{y_t})^2\\) For a stationary time series, using the three conditions the Autocorrelation Function (ACF) denoted by \\(\\rho(s)\\) is given by: \\[\\begin{align} ACF(s) \\ or \\ \\rho(s)=\\frac{\\gamma(s)}{\\gamma(0)} \\end{align}\\] Non-zero values of the ACF indicates presences of serial correlation in the data. Figure 6.3 shows the ACF for a stationary time series with positive serial correlation. If your data is stationary then the ACF should eventually converge to 0. For a non-stationary data, the ACF function will not decay over time. Figure 6.3: ACF for a Stationary Time Series 6.1.3 Partial Autocorrelation The ACF captures the relationship between the current period value of a time series and all of its past observations. It includes both direct as well as indirect effects of the past observations on the current period value. Often times it is of interest to measure the direct relationship between the current and past observations, partialing out all indirect effects. The partial autocorrelation function (PACF) for a stationary time series \\(y_t\\) at lag \\(s\\) is the direct correlation between \\(y_t\\) and \\(y_{t-s}\\), after filtering out the linear influence of \\(y_{t-1},\\ldots,y_{t-s-1}\\) on \\(y_t\\). Figure 6.4 below shows the PACF for a stationary time series where only one lag directly affects the time series in the current period. Figure 6.4: PACF for a Stationary Time Series 6.1.4 Lag operator A lag operator denoted by \\(L\\) allows us to write ARMA models in a more concise way. Applying lag operator once moves the time index by one period; applying it twice moves the time index back by two period; applying it \\(s\\) times moves the index back by \\(s\\) periods. \\[ Ly_t=y_{t-1} \\] \\[ L^2y_t=y_{t-2} \\] \\[ L^3y_t=y_{t-3} \\] \\[\\vdots\\] \\[ L^sy_t=y_{t-s} \\] 6.2 Autoregressive (AR) Model A stationarytime series \\(\\{x_t\\}\\) can be modeled as an AR process. In general, an AR(p) model is given by: \\[\\begin{equation} y_t = \\phi_0 +\\phi_1 y_{t-1} + \\phi_2 y_{t-2} + ...... + \\phi_p y_{t-p}+\\epsilon_t \\end{equation}\\] Here \\(\\phi_i\\) captures the effect of \\(y_{t-i}\\) on \\(y_t\\). The order of the AR process is not known apriori. It is common to use either AIC or BIC to determine the optimal lag length for an AR process. Using the Lag operator, we can rewrite the above AR(p) model as follows: \\[ \\Phi(L)y_t=\\phi_0+\\epsilon_t \\] where \\(\\displaystyle \\Phi(L)\\) is a polynomial of degree \\(p\\) in L: \\[ \\Phi(L) = 1-\\phi_1 L - \\phi_2 L^2- \\ldots\\ldots\\ldots\\ldots -\\phi_p L^p\\] For example, an AR(1) model can be written as: \\[y_t=\\phi_0+\\phi_1 y_{t-1} + \\epsilon_t \\Rightarrow \\Phi(L)y_t=\\phi_0+\\epsilon_t\\] where, \\[ \\Phi(L) = 1-\\phi_1 L \\] Characteristic equation: A characteristic equation is given by: \\[\\Phi(L)=0\\] The roots of this equation play an important role in determining the dynamic behavior of a time series. 6.2.1 Unit root and Stationarity For a time series to be stationary there should be no unit root in its characteristic equation. In other words, all roots of the characteristic equation must fall outside the unit circle. Consider the following AR(1) model: \\[\\Phi(L)y_t = \\phi_0 + \\epsilon_t\\] The characteristic equation is given by: \\[\\Phi(L)=1-\\phi_1L=0 \\] The root that satisfies the above equation is: \\[ L^*=\\frac{1}{\\phi_1}\\] For no unit root to be present, \\(L^*&gt;|1|\\) which implies that \\(|\\phi_1|&lt;1\\). Typically, for any AR process to be stationary, some restrictions will be imposed on the values of \\(\\phi_i&#39;s\\), the coefficients of the lagged variables in the model. 6.2.2 Properties of an AR(1) model A stationary AR(1) model is given by: \\[ y_t=\\phi_0 +\\phi_1 y_{t-1}+ \\epsilon_t \\quad ; \\ \\epsilon_t\\sim WN(0, \\sigma_\\epsilon^2) \\ and \\ |\\phi_1|&lt;1\\] \\(\\displaystyle \\phi_1\\) measures the persistence in data. A larger value indicates shocks to \\(y_t\\) dissipate slowly over time. Stationarity of \\(y_t\\) implies certain restrictions on the AR(1) model. Constant long run mean: is the unconditional expectation of \\(y_t\\): \\[ E(y_t) = \\mu_y= \\frac{\\phi_0}{1-\\phi_1} \\] Constant long run variance: is the unconditional variance of \\(y_t\\): \\[ Var(y_t)=\\sigma^2_y= \\frac{\\sigma^2_\\epsilon}{1-\\phi_1^2}\\] ACF function: \\[ \\rho(s) = \\phi_1^s\\] PACF function: \\[\\begin{equation*} PACF(s) = \\begin{cases} \\phi_1 &amp; \\text{if s=1}\\\\ 0 &amp; \\text{if s&gt;1} \\end{cases} \\end{equation*}\\] 6.3 Estimating an AR model When estimating the AR model we have two alternatives: OLS: biased (but consistent) estimates. Also, later on when we add MA components we cannot use OLS. Maximum Likelihood Estimation (MLE): can be used to estimate AR as well as MA components 6.3.1 Maximum Likelihood Estimation (MLE) MLE approach is based on the following idea: what set of values of our parameters maximize the likelihood of observing our data if the model we have was used to generate this data. Likelihood function: is a function that gives us the probability of observing our data given a model with some parameters. 6.3.1.1 Likelihood vs Probability Consider a simple example of tossing a coin. Let \\(X\\) denotes the random variable that is the outcome of this experiment being either heads or tails. Let \\(\\theta\\) denote the probability of heads which implies \\(1-\\theta\\) is the probability of obtaining tails. Here, \\(\\theta\\) is our parameter of interest. Suppose we toss the coin 10 times and obtain the following data on \\(X\\): \\[X=\\{H,H,H,H,H,H,T,T,T,T\\}\\] Then, the probability of obtaining this sequence of X is given by: \\[Prob (X|\\theta)=\\theta^6 (1-\\theta)^4\\] This is the probability distribution function the variable \\(X\\). As we change \\(X\\), we get a different probability for a given value of \\(\\theta\\). Now let us ask a different question. Once we have observed the sequence of heads and tails, lets call it our data which is fixed. Then, what is probability of observing this data, if our probability distribution function is given by the equation above? That gives us the likelihood function: \\[ L(\\theta)=Prob(X|\\theta)=\\theta^6(1-\\theta)^4\\] Note that with fixed \\(X\\), as we change \\(\\theta\\) the likelihood of observing this data will change. This is an important point that distinguishes likelihood function from the probability distribution function. Although both have the same equation, the probability function is a function of the data with the value of the parameter fixed, while the likelihood function is a function of the parameter with the data fixed. 6.3.1.2 Maximum Likelhood Estimation Now we are in a position to formally define the likelihood function. Definition 6.2 Let \\(X\\) denotes a random variable with a given probability distribution function denoted by \\(f(x_i|\\theta)\\). Let \\(D=\\{x_1, x_2,\\dots,x_n\\}\\) denote a sample realization of \\(X\\). Then, the likelhood function, denoted by \\(L(\\theta)\\) is given by: \\[L(\\theta)=f(x_1,x_2,\\dots,x_n|\\theta)\\] If we further assume that each realization of \\(X\\) is independent of the others, we get: \\[L(\\theta)=f(x_1,x_2,\\dots,x_n|\\theta)=f(x_1|\\theta)\\times f(x_2|\\theta) \\times \\dots \\times f(x_n|\\theta)\\] A mathematical simplification is to work with natural logs of the likelihood function, which assuming independently distributed random sample, gives us: \\[ lnL(\\theta)=ln(f(x_1|\\theta)\\times f(x_2|\\theta) \\times \\dots \\times f(x_n|\\theta))=\\sum_{i=1}^{N}ln(f(x_i|\\theta))\\] Definition 6.3 The maximum likelihood estimator, denoted by \\(\\hat{\\theta}_{MLE}\\), maximizes the log likelihood function: \\[ \\hat{\\theta}_{MLE} \\equiv arg \\max_{\\theta} lnL(\\theta) \\] Example 6.1 Compute maximum likelihood estimator of \\(\\mu\\) of an indpendently distributed random variable that is normally distributed with a mean of \\(\\mu\\) and a variance of \\(1\\): \\[ f(y_t|\\mu)=\\frac{1}{\\sqrt{2\\pi}}e^{-\\frac{1}{2} (y_t-\\mu)^2}\\] Solution: The log likelihood function is given by: \\[lnL= -Tln2\\pi-\\frac{1}{2}\\sum_{t=1}^T(y_t-\\mu)^2 \\] From the first order condition, we get \\[ \\frac{\\partial LnL}{\\partial \\mu}=\\sum_{t=1}^T(y_t-\\mu)=0\\Rightarrow \\hat{\\mu}_{MLE}=\\frac{\\sum_{t=1}^T y_t}{T}\\] 6.3.2 MLE of an AR(p) model One complication we face in estimating an AR(p) model is that by definition the realizations of the variable are not independent of each other. As a result we cannot simplify the likelihood function by multiplying individual probability density functions to obtain the joint probability density function, i.e., \\[ f(y_1,y_2,\\dots,y_T|\\theta) \\neq f(y_1|\\theta)\\times f(y_2|\\theta)\\times \\dots \\times f(y_T|\\theta)\\] Furthermore, as the order of AR increases, the joint density function we need to estimate becomes even more complicated. In this class we will focus on the method that divides the joint density into the product of conditional densities and density of a set of initial values. The idea comes from the conditional probability formula for two related events \\(A\\) and \\(B\\): \\[ P(A|B) =\\frac{P(\\text{A and B})}{P(B)} \\Rightarrow P(\\text{A and B}) = P(A|B)\\times P(B) \\] In the time series context, I will explain this for a stationary AR(1) model. We know that in this model only last period observation directly affects the current period value. Hence, consider the first two observations of a stationary time series: \\(y_1\\) and \\(y_2\\). Then the joint density of these adjacent observations is given by, \\[ f(y_1,y_2;\\theta)= f(y_2|y_1; \\theta)\\times f(y_1;\\theta)\\] Similarly, for the first three observations we get: \\[ f(y_1,y_2,y_3;\\theta)= f(y_3|y_2; \\theta)\\times f(y_2|y_1; \\theta) \\times f(y_1; \\theta)\\] Hence, for \\(T\\) observations we get: \\[ f(y_1,y_2,y_3, ...,y_T; \\theta)= f(y_T|y_{T-1};\\theta)\\times f(y_{T-1}|y_{T-2}; \\theta)\\times.... \\times f(y_1; \\theta)\\] The log-likelihood function is given by: \\[ ln \\ L(\\theta) = ln \\ f(y_1;\\theta) + \\sum_{t=2}^{T} ln \\ f(y_t|y_{t-1}; \\theta) \\] We can then maximize the above likelihood function to obtain an MLE estimator for the AR(1) model. 6.3.3 Selection of optimal order of the AR model Note that apriori we do not know the order of the AR model for any given time series. We can determine the optimal lag order by using either AIC or BIC. The process is as follows: Set \\(p=p_{max}\\) where \\(p_{max}\\) is an integer. A rule of thumb is to set \\[p_{max}=integer\\left[12\\times \\left(\\frac{T}{100}\\right)^{0.25}\\right]\\] Estimate all AR models from \\(p=1\\) to \\(p=p_{max}\\). Select the final model as the one with lowest AIC or lowest BIC. 6.3.4 Forecasting using AR(p) model Having estimated our AR(p) model with the optimal lag length, we can use the conditional mean to compute the forecast and conditional variance to compute the forecast errors. Consider an AR(1) model: \\[y_t=\\phi_0+\\phi_1 y_{t-1} +\\epsilon_t\\] Then, the 1-period ahead forecast is given by: \\[f_{t,1}=E(y_{t+1}|\\Omega_t)=\\phi_0+\\phi_1 y_t\\] Similarly, the 2-period ahead forecast is given by: \\[f_{t,2}=E(y_{t+2}|\\Omega_t)=\\phi_0+\\phi_1 E(y_{t+1}|\\Omega_t) =\\phi_0+\\phi_1f_{t,1}\\] In general, we can get the following recursive forecast equation for h-period’s ahead: \\[f_{t,h}=\\phi_0+\\phi_1 f_{t,h-1}\\] Correspondingly, the h-period ahead forecast error is given by: \\[e_{t,h}=y_{t+h}- f_{t,h}=\\epsilon_{t+h}+\\phi_1 e_{t,h-1}\\] Theorem 6.1 The h-period ahead forecast converges to the unconditional mean of \\(y_t\\), i.e., \\[\\lim_{h\\to\\infty} f_{t,h}=\\mu_y=\\frac{\\phi_0}{1-\\phi_1}\\] Theorem 6.2 The variance of the h-period ahead forecast error converges to the unconditional variance of \\(y_t\\), i.e., \\[\\lim_{h\\to\\infty} Var(e_{t,h})=\\sigma^2_y=\\frac{\\sigma^2_\\epsilon}{1-\\phi_1^2}\\] 6.4 Moving Average (MA) Model Another commonly used method for capturing the cyclical component of the time series is the moving average (MA) model where the current value of a time series linearly depends on current and past shocks. Formally, a stationary time series \\(\\{y_t\\}\\) can be modeled as an MA(q) process: \\[\\begin{equation} y_t = \\theta_0 + \\epsilon_t + \\theta_1 \\epsilon_{t-1} + \\theta_2 \\epsilon_{t-2} + ...... + \\theta_q \\epsilon_{t-q} \\end{equation}\\] Using lag operator, we can write this in more compact form as: \\[y_t = \\theta_0 +\\Theta(L) \\epsilon_t\\] where \\(\\Theta(L)=1+\\theta_1 L+ \\theta_2 L^2+...+\\theta_q L^q\\) is lag polynomial of order \\(q\\). Note that because each one of the current and past shocks are white noise processes, an MA(q) model is always stationary. 6.4.1 Invertibility of an MA process Consider the following MA(1) process with\\(\\theta_0=0\\) for simplicity: \\[y_t=\\epsilon_t +\\theta_1 \\epsilon_{t-1}\\] Using the lag operator we can rewrite this equation as follows: \\[y_t= (1+\\theta_1L)\\epsilon_t \\Rightarrow y_t(1+\\theta_1 L) ^{-1}=\\epsilon_t\\] Note that if \\(|\\theta_1|&lt;1\\), then we can use the Taylor series expansion centered at 0 and get: \\[(1+\\theta_1 L)^{-1}=1-\\theta_1 L+(\\theta_1L)^2-(\\theta_1L)^3+ (\\theta_1L)^4-...... \\] Hence, an MA(1) can be rewritten as follows: \\[y_t (1-\\theta_1 L+(\\theta_1L)^2-(\\theta_1L)^3+ (\\theta_1L)^4-......)=\\epsilon_t\\] \\[\\Rightarrow y_t -\\theta_1 y_{t-1} +\\theta_1^2y_{t-2}-\\theta_1^3 y_{t-3}....=\\epsilon_t\\] Rearranging terms, we get the \\(AR(\\infty)\\) representation for an invertible MA(1) model: \\[y_t=-\\sum_{i=1}^{\\infty}(-\\theta_1)^i \\ y_{t-i}+\\epsilon_t\\] Definition 6.4 An MA process is invertible if it can be represented as a stationary \\(AR(\\infty)\\). 6.4.2 Properties of an invertible MA(1) An invertible MA(1) model is given by: \\[ y_t = \\theta_0 + \\epsilon_t + \\theta_1 \\epsilon_{t-1} \\quad ; \\ \\epsilon_t\\sim WN(0, \\sigma_\\epsilon^2) \\ and \\ |\\theta_1|&lt;1\\] Constant unconditional mean of \\(y_t\\): \\[E(y_t)=\\mu_y =\\theta_0 \\] Constant unconditional variance of \\(y_t\\): \\[Var(y_t)=\\sigma^2_y=\\sigma^2_\\epsilon(1+\\theta_1^2)\\] ACF function: \\[\\begin{equation*} ACF(s) = \\begin{cases} \\frac{\\theta_1}{1+\\theta_1^2} &amp; \\text{if s=1}\\\\ 0 &amp; \\text{if s&gt;1} \\end{cases} \\end{equation*}\\] PACF function: using the invertibility it is evident that PACF of an MA(1) decays with \\(s\\). 6.4.3 Forecast based on MA(q) Like before, the h-period ahead forecast is the conditional expected value of the time series. Consider an MA(1) model: \\[y_t=\\theta_0 +\\epsilon_t + \\theta_1 \\epsilon_{t-1}\\] Then, the 1-period ahead forecast is given by: \\[f_{t,1}=E(y_{t+1}|\\Omega_t)=\\theta_0+ \\theta_1 \\epsilon_{t-1}\\] The h-period ahead forecast for \\(h&gt;1\\) is given by: \\[f_{t,h}=E(y_{t+h}|\\Omega_t)=\\theta_0\\] In general, for an MA(q) model, the forecast for \\(h&gt;q\\) is the long run mean \\(\\theta_0\\). This is why we say that an MA(q) process has a memory of q periods. 6.5 ARMA(p, q) An ARMA model simply combines both AR and MA components to model the dynamics of a time series. Formally, \\[\\begin{equation} y_t = \\phi_0 +\\phi_1 y_{t-1} + \\phi_2 y_{t-2} + ...... + \\phi_p y_{t-p}+\\epsilon_t + \\theta_1 \\epsilon_{t-1} + \\theta_2 \\epsilon_{t-2} + ...... + \\theta_q \\epsilon_{t-q} \\end{equation}\\] Note that: Estimation is done by maximum likelihood method. Optimal order for AR and MA components is selected using AIC and/or BIC. The forecast of \\(y_t\\) from an ARMA(p,q) model will be dominated by the AR component for \\(h&gt;q\\). To see this consider the following ARMA(1,1) model: \\[y_t = \\phi_0 +\\phi_1 y_{t-1}+ \\epsilon_t + \\theta_1 \\epsilon_{t-1}\\] Then, the 1-period ahead forecast is: \\[f_{t,1} = E(y_{t+1}|\\Omega_t) = \\phi_0 + \\phi_1 y_t + \\theta_1 \\epsilon_{t-1}\\] Here both MA and AR component affect the forecast. But now consider the 2-period ahead forecast: \\[f_{t,2} = E(y_{t+2}|\\Omega_t) = \\phi_0 + \\phi_1 f_{t,1}\\] Hence, no role is played by the MA component in determining the 2-period ahead forecast. For any \\(h&gt;1\\) only the AR component affects the forecast from this model. 6.6 Integrated ARMA or ARIMA(p,d,q) Thus far we have assumed that our data is stationary. However, often we may find that this assumption is not supported in practice. In such a case we need to tranform our data appropriately before estimating an ARMA model. The procedure can be summarized as follows: Determine whether there is a unit root in data or not. Presence of unit root indicates non-stationarity. We will use Augmented Dickey-Fuller (ADF) test for this purpose. If data is non-stationary, then we need to appropriately transform our data to make it stationary. Once we have obtained a stationary transformation of our original data, we can proceed and estimate the ARMA model as before. 6.7 Trend Stationary vs Difference Stationary Time Series There are two types of time series we often encounter in real world: Trend-stationary: a time-series variable is non-stationary becuase it has a deterministic trend. Once we detrend our data then it will become stationary. In this case the appropriate transformation is to estimate a trend model and then use the residual as the detrended stationary data. For example, suppose our data has a linear trend given by: \\[y_t = \\beta_0 +\\beta_1 t +\\epsilon_t\\] Then the OLS residual from this model, \\(e_t=y_t-\\hat{y_t}\\) is the detrended \\(y_t\\) which will be stationary. Hence, we will estimate an ARMA(p,q) model using this detrended variable. Difference-stationary: a time-series variable is non-stationary because it contains a stochastic trend. Here, the transformation requires us to difference the orignial data until we obtain a stationary time series. Let \\(d\\) denote the minimum number of differences needed to obtain a stationary time series: \\[\\Delta_d \\ y_t=(1-L)^d \\ y_t\\] In this case, we say that \\(y_t\\) is intergrated of order \\(d\\) or more formally, \\(y_t\\) is an \\(I(d)\\) process. Hence, for \\(d=1\\) we obtain an \\(I(1)\\) process implying that: \\[\\Delta_1 \\ y_t=(1-L)^1 \\ y_t=y_t-y_{t-1} \\quad \\text{is stationary}\\] In otherwords, the first difference of an I(1) process is stationary. Similarly for \\(d=2\\), we obtain an \\(I(2)\\) process where second difference will be stationary and so forth. 6.8 Testing for a unit root Consider the following AR(1) model with no trend and intercept: \\[y_t=\\phi_1 y_{t-1} +\\epsilon_t \\ quad ; \\epsilon_t\\sim WN(0,\\sigma^2_\\epsilon)\\] We know that if \\(\\phi_1=1\\) we have a unit root in this data. Lets subtract \\(y_{t-1}\\) from both sides and rewrite this model as: \\[y_t-y_{t-1}= (\\phi_1-1)y_{t-1}+\\epsilon_t \\] Define \\(\\rho=phi_1-1\\). Then, we get: \\[\\Delta y_t= \\rho \\ y_{t-1}+\\epsilon_t \\] We can now estimate the above model and carry out the following test known as the Dickey-Fuller (DF) test: \\[H_0: \\rho=0 \\] \\[H_A: \\rho&lt;0\\] If the null hypothesis is not rejected, then we do not have sample evidence against the statement that \\(\\rho=0 \\Rightarrow \\phi_1=1\\). Hence, we conclude that there is no evidence against the statement that there is unit root in the data. In contrast, if we reject the null hypothesis, then we can conclude that there is no unit root and hence the data is stationary. The t- statistic is for the above test is denoted by \\(\\tau_1\\) and is given by: \\[\\tau_1 =\\frac{\\hat{\\rho}}{se(\\hat{\\rho})}\\] Under the null hypothesis this test statistic follows the DF-distribution and the critical values are provided in most statistical softwares. Given that this is a left-tail test, the decision rule is that if the test statistic is less than the critical value then we reject the null hypothesis. There are two issues we face when implementing this test in practice: First, the above procedure assumes that there is no intercept and trend in the data. In real world, we cannot make that assumption and must extend the test procedure to accomodate a non-zero intercept and trend. Hence, we have the following two additional versions of the DF test: Constant and no trend model: Here our AR(1) model is \\[\\Delta y_t= \\phi_0 + \\rho \\ y_{t-1}+\\epsilon_t \\] Now we can do two possible tests. The first test is that of the unit root: \\[H_0: \\rho=0 \\] \\[H_A: \\rho&lt;0\\] The t statistic for this test is denoted by \\(\\tau_2\\) and is given by: \\[\\tau_2 =\\frac{\\hat{\\rho}}{se(\\hat{\\rho})}\\] If the test statisitic is less than the critical value, we reject the null. The second test we can do is: \\[H_0: \\rho=\\phi_0=0 \\] \\[H_A: Not \\ H_0\\] The test statistic for this test is denoted by \\(\\phi_1\\). If the test statistic exceeds the critical value then we reject the null. Constant and linear trend model: Here our AR(1) model is \\[\\Delta y_t= \\phi_0 + \\beta \\ t+ \\rho \\ y_{t-1}+\\epsilon_t \\] Now we can do three possible tests. The first test is that of the unit root; \\[H_0: \\rho=0 \\] \\[H_A: \\rho&lt;0\\] The t statistic for this test is denoted by \\(\\tau_3\\) and is given by: \\[\\tau_3 =\\frac{\\hat{\\rho}}{se(\\hat{\\rho})}\\] If the test statisitic is less than the critical value, we reject the null. The second test is: \\[H_0: \\rho=\\phi_0=\\beta=0 \\] \\[H_A: Not \\ H_0\\] The test statistic for this test is denoted by \\(\\phi_2\\). If the test statistic exceeds the critical value then we reject the null. Finally the third test is: \\[H_0: \\rho=\\beta=0 \\] \\[H_A: Not \\ H_0\\] The test statistic for this test is denoted by \\(\\phi_3\\). If the test statistic exceeds the critical value then we reject the null. Second, we only have allowed for AR(1). We need to extend the above testing procedure for higher order AR models. The Augmented DF (ADF) test allows for higher order lags in testing for a unit root. For example, the model with an intercept, trend, and \\(p\\) lags is given by: \\[\\Delta y_t= \\phi_0 + \\beta \\ t+ \\rho \\ y_{t-1}+\\sum_{i=2}^p\\delta_i y_{t-i}+\\epsilon_t \\quad where \\ \\rho=\\sum_{i=1}^p \\phi_i-1\\] 6.8.1 Testing for unit root in USD/CAD exchange rate In this application we will test for unit root in US-Canada exchange rate. For this purpose we work with monthly data from Jan 1971 through Oct 2018. Below I show the results for 3 models using the urca package in R. ## ## ############################################### ## # Augmented Dickey-Fuller Test Unit Root Test # ## ############################################### ## ## Test regression none ## ## ## Call: ## lm(formula = z.diff ~ z.lag.1 - 1 + z.diff.lag) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.069820 -0.009107 0.000237 0.010474 0.125124 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## z.lag.1 0.0001568 0.0005601 0.28 0.78 ## z.diff.lag 0.2574519 0.0385402 6.68 5.24e-11 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.01746 on 632 degrees of freedom ## Multiple R-squared: 0.06634, Adjusted R-squared: 0.06338 ## F-statistic: 22.45 on 2 and 632 DF, p-value: 3.8e-10 ## ## ## Value of test-statistic is: 0.28 ## ## Critical values for test statistics: ## 1pct 5pct 10pct ## tau1 -2.58 -1.95 -1.62 ## ## ############################################### ## # Augmented Dickey-Fuller Test Unit Root Test # ## ############################################### ## ## Test regression drift ## ## ## Call: ## lm(formula = z.diff ~ z.lag.1 + 1 + z.diff.lag) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.067869 -0.009589 -0.000771 0.009999 0.123380 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 0.011288 0.005352 2.109 0.0353 * ## z.lag.1 -0.008878 0.004320 -2.055 0.0403 * ## z.diff.lag 0.261053 0.038473 6.785 2.67e-11 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.01742 on 631 degrees of freedom ## Multiple R-squared: 0.07208, Adjusted R-squared: 0.06914 ## F-statistic: 24.51 on 2 and 631 DF, p-value: 5.61e-11 ## ## ## Value of test-statistic is: -2.0552 2.2637 ## ## Critical values for test statistics: ## 1pct 5pct 10pct ## tau2 -3.43 -2.86 -2.57 ## phi1 6.43 4.59 3.78 ## ## ############################################### ## # Augmented Dickey-Fuller Test Unit Root Test # ## ############################################### ## ## Test regression trend ## ## ## Call: ## lm(formula = z.diff ~ z.lag.1 + 1 + tt + z.diff.lag) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.067861 -0.009434 -0.000801 0.009864 0.123206 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 1.136e-02 5.364e-03 2.117 0.0346 * ## z.lag.1 -9.173e-03 4.505e-03 -2.036 0.0422 * ## tt 9.159e-07 3.941e-06 0.232 0.8163 ## z.diff.lag 2.613e-01 3.852e-02 6.784 2.7e-11 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.01743 on 630 degrees of freedom ## Multiple R-squared: 0.07216, Adjusted R-squared: 0.06775 ## F-statistic: 16.33 on 3 and 630 DF, p-value: 3.114e-10 ## ## ## Value of test-statistic is: -2.0362 1.5249 2.1357 ## ## Critical values for test statistics: ## 1pct 5pct 10pct ## tau3 -3.96 -3.41 -3.12 ## phi2 6.09 4.68 4.03 ## phi3 8.27 6.25 5.34 For the first model with no constant and trend, the test statistic \\(\\tau_1= 0.2469\\) and the 5% critical value is -1.95. For the second model with a constant, the test statistics is \\(\\tau_2= -1.9315\\) and the 5% critical value is -2.86. Finally, for the third model with a trend, the test statistic \\(\\tau_3= -1.8839\\) and the 5% critical value is -3.41. In each, because the test statistic is greater than the critical value, we do not reject the null hypothesis and conclude there is unit root. 6.9 Box-Jenkins Method for estimating ARIMA(p,d,q) Box-Jenkins is a three-step procedure for finding the best fitting ARIMA(p,d,q) for a non-statinary time series. Model identification: here we determine the order of integration \\(d\\), and the optimal number of AR and MA components, \\(p\\) and \\(q\\) respectively. To determine \\(d\\), we conduct ADF test on successive differences of the original time series. The order of integration is the number times we difference our data to obtain stationarity. This is followed by estimating ARMA model for different combinations of \\(p\\) and \\(q\\). The optimal structure is chosen using either AIC or BIC. Parameter estimation: we estimate the identified model from the previous step using ML estimation. Model Evaluation: mostly showing that the residuals from the optimal model is a white noise process. We can do this by using the Breusch-Godfrey LM test of serial correlation for the residuals. If residuals from the final model are white noise then there should be no serial correlation. "],["vector-autoregression-var-model.html", "Chapter 7 Vector Autoregression (VAR) Model 7.1 Reduced-form VAR 7.2 Structural VAR 7.3 Cholesky Decomposition and Recursive VAR model 7.4 Impulse Response Function, Forecast Error Variance Decomposition, and Granger Causality 7.5 Application: Effect of monetary policy on inflation and unemployment", " Chapter 7 Vector Autoregression (VAR) Model Thus far our analysis has been limited to a univariate time series. Often one maybe interested in understanding the dynamics of multiple time series variables. Vector Autoregression (VAR) model is one of the most commonly used model for this purpose. Suppose you have \\(N\\) time series variables in your sample Then a VAR model is a system of \\(N\\) linear equations where each variable is modeled as a linear function of its own lags and current and past values of the remaining \\(N-1\\) variables. In this sense a VAR model combines and extends the the AR model and distributed lag model we covered earlier. There are two main ways we can specify a VAR model, each distinguished by the treatment of contemporaneous effects among variable included in the model. To make each type’s main features salient, suppose that we have three variables in our model: inflation (denoted by \\(\\pi\\)), unemployment (denoted by \\(u\\)), and the federal fund rate (denoted by \\(i\\)). In the remainder of this chapter will use this 3-variable system as our example. 7.1 Reduced-form VAR In a reduced-form VAR we abstract away from any contemporaneous linkages among variables in the model and hence in that sense take an atheoretical approach to estimating dynamic relationships among these variables. Specifically, we assume that each variable in the model is a function of its own lags and lags of remaining variables in the system. For example, using our 3 variables, a reduced-form VAR(1) is given by: \\[\\pi_t = a_{10} + a_{11} \\pi_{t-1} + a_{12} u_{t-1} + a_{13} i_{t-1} + e_{1t}\\] \\[u_t = a_{20} + a_{21} \\pi_{t-1} + a_{22} u_{t-1} + a_{23} i_{t-1} + e_{2t}\\] \\[i_t = a_{30} + a_{31} \\pi_{t-1} + a_{32} u_{t-1} + a_{33} i_{t-1} + e_{3t}\\] Note that: The above system of 3-equations can easily be estimated as it only includes lagged data for each variable as independent variable, which by definition is pre-determined. Hence, we can estimate each equation separately by OLS. In the above example we use 1 lag for simplicity. In practice the number of lagged values to include in each equation can be determined using AIC or BIC. Each equation will provide a forecast for that particular variable. Hence, in our example we can generate forecasts for all three variables in our model. One important drawback of the reduced-form VAR is that it cannot be used for structural inference and policy analysis. For example, suppose we are want to find out what will be the effect of raising the ffr by 50 basis points on inflation and unemployment? To answer this question, we need the shocks in each equation to be independent of each other. Only then, for example, we can say that \\(e_{3t}\\) represents shock to the FFR alone. However, in the reduced-form VAR, because each variable is related to each other, shocks in each equation are also correlated to each other. 7.2 Structural VAR The reduced-form VAR specified above is atheoretical in the sense that it does not impose any economic structure on the relationships between different variables. As a result a reduced-form model cannot be used to uncover causal relationships between correlated variables. A structural VAR model allows each variable to depend on past as well as current values of other variables in the system. As a result, a structural VAR adds contemporaneous linkages among variables included in the model. Continuing with our example, a structural version of the 3-variable VAR can be written as follows: \\[\\pi_t = \\beta_{11} + \\beta_{12} u_t + \\beta_{13} i_t + \\phi_{11} \\pi_{t-1} + \\phi_{12} u_{t-1} + \\phi_{13} i_{t-1} + \\epsilon_{1t}\\] \\[u_t = \\beta_{21} + \\beta_{22} \\pi_t+ \\beta_{23} i_t+\\phi_{21} \\pi_{t-1} + \\phi_{22} u_{t-1} + \\phi_{23} i_{t-1} + \\epsilon_{2t}\\] \\[i_t = \\beta_{31} + \\beta_{32}\\pi_t + \\beta_{33}u_t+ \\phi_{31} \\pi_{t-1} + \\phi_{32} u_{t-1} + \\phi_{33} i_{t-1} + \\epsilon_{3t}\\] There are three key things to note here: In each equation we now have contemporaneous linkages among variables. For example, in the first equation, \\(\\beta_{12}\\) and \\(\\beta_{13}\\) capture the effect of changes in period \\(t\\) values of unemployment and ffr on the period \\(t\\) value of inflation. By definition the error terms are uncorrelated across equations and hence each error term can be interpreted as representing a pure shock to that particular variable. For example, \\(\\epsilon_{3t}\\) represents shocks to the ffr often caused by the monetary policy actions of the Fed. OLS estimation of each equation separately would provide biased estimates as there is a simultaneity bias inherent in the specification of the structural VAR. For example, in the inflation equation, inflation depends on current period unemployment and interest rate. But, in the unemployment equation, unemployment depends on current period inflation and interest rate as well. This kind of reverse causality causes OLS estimator to be biased. Consequently, a structural VAR model cannot be estimated using OLS. In order to process we need to impose some kind of identifying restrictions on the structural VAR model to deal with the contemporaneous linkages among variables. Such restrictions often come from economic theory and may involve the entire model or a just a single equation. However, to conduct structural inference we have to use economic theory to afford structural interpretation to shocks of our VAR model. 7.3 Cholesky Decomposition and Recursive VAR model One solution that falls in between the reduced-form VAR with no structural interpretation and the structural VAR with full set of contemporaneous linkages is the recursive VAR model. In this specification, the error term in each equation is assumed to be uncorrelated with the error term in the preceding equations. This is accomplished by assuming some sort of ordering among variables in the VAR model so that only some variables contemporaneously affect others. For example, suppose we use the following ordering: inflation, unemployment, and the federal fund rate (ffr). This ordering will imply the following recursive VAR model: \\[\\pi_t = \\beta_{11} + \\phi_{11} \\pi_{t-1} + \\phi_{12} u_{t-1} + \\phi_{13} i_{t-1} + \\epsilon_{1t}\\] \\[u_t = \\beta_{21} + \\beta_{22} \\pi_t+\\phi_{21} \\pi_{t-1} + \\phi_{22} u_{t-1} + \\phi_{23} i_{t-1} + \\epsilon_{2t}\\] \\[i_t = \\beta_{31} + \\beta_{32}\\pi_t + \\beta_{33}u_t+ \\phi_{31} \\pi_{t-1} + \\phi_{32} u_{t-1} + \\phi_{33} i_{t-1} + \\epsilon_{3t}\\] Note that: The ordering we assumed: inflation, unemployment, and ffr, implies that the first variable (inflation) has no contemporaneous linkage with unemployment and ffr. The second variable (unemployment) is affected by contemporaneous inflation and the third variable (ffr) is affected by both contemporaneous inflation and unemployment. The main implication of this ordering is that \\(cor(\\epsilon_{1t},\\epsilon_{2t})=0\\), \\(cor(\\epsilon_{2t},\\epsilon_{3t})=0\\), and \\(cor(\\epsilon_{1t},\\epsilon_{3t})=0\\). In practical implementations of the recursive VAR model, it is common to first estimate the reduced-form VAR model using OLS for each equation separately. Then, we decompose the covariance matrix to reduced-form residuals using Cholesky decomposition method to obtain uncorrelated error structure consistent with the recursive VAR model specified above. This can be used to investigate how shocks to one variable affect other variables in the system. If we change the ordering, we will get different results. In a model with \\(N\\) variables, there are N! possible orderings. So in our example, there are 3!= 6 possible alternative specifications for the VAR model. Hence, this approach requires us to judiciously choose the ordering of the variables. 7.4 Impulse Response Function, Forecast Error Variance Decomposition, and Granger Causality In addition to estimating each equation and providing a forecast of all variables in the system, there are two additional outputs produced by a VAR model which can be used for both descriptive and inference purposes. This analysis requires us to either use a recursive VAR model or impose some restrictions based on economic theory so that each shock can be interpreted as a shock to that particular variable. In this chapter we will use the recursive VAR structure when discussing impulse response functions and variance decomposition. 7.4.1 Impulse response function Suppose we are interested in finding out how shock to one variable in the system at time \\(t\\) affects the dynamics of other variables. For example, suppose there is unanticipated increase in the ffr caused by the actions of the Fed. What would be the dynamic response of inflation and unemployment to this monetary policy shock? Using the recursive VAR, we can interpret the shock to the FFR (the last variable in our ordering) as a pure interest rate shock because it is by construction uncorrelated with shocks to inflation and unemployment. The impuse response produced by the VAR model traces out the response of current and future values of unemployment and inflation to one-unit increase in the error term of the ffr equation, holding error terms in inflation and unemployment equation at zero. We can study both the impact effect as well as the cumulative effect of such a shock to ffr on unemployment and inflation. 7.4.2 Forecase Error Variance Decomposition Another useful output from an estimated VAR model is the forecast error variance decomposition (fevd). Here, we can address the following question: following a shock to one of the variables in the VAR model what percentage of the variance in the forecast error of other variables in the model can be attributed to this particular shock? For example, what percentage of the forecast error variance of inflation can be attributed to the shock in inflation, shock in unemployment, and shock to ffr. In this sense the forecast error variance decomposition measures the amount of each variable in the VAR model contributes to the other variables in the autoregression. 7.4.3 Granger causality Another important analysis that one can conduct using a VAR model is Granger-causality. As a bi-variate concept, Granger causality means that lags of one variable improves our capacity to predict another variable. For example, if unemployment Granger-causes inflation, then lags of unemployment have non-zero coefficients in the reduced-form inflation equation. Formally, consider the following regression: \\[\\pi_t=\\beta_0 + \\sum_{i=1}^{P} \\beta_i u_{t-i} \\sum_{i=1}^{P} \\delta_i \\pi_{t-i} + \\epsilon_t\\] To test whether unemployment Granger causes inflation we can conduct the following hypothesis test: \\[H_0: \\beta_1=\\beta_2=...=\\beta_p=0\\] \\[H_A: \\text{Not} \\ H_0\\] This is an F-test and rejection of the null hypothesis indicates unemployment Granger-causes inflation. 7.5 Application: Effect of monetary policy on inflation and unemployment The Federal reserve bank (The Fed) in the U.S. has a dual mandate: to maintain low inflation and low unemployment. The monetary policy stance of the Fed is expressed in terms of the federal funds rate (ffr). In this section we learn how to estimate a VAR model with three variables: inflation (\\(\\pi_t\\)), unemployment (\\(u_t\\)), and interest rate (\\(i_t\\)). For this purpose we will use quarterly data on these variables from 1960Q1 through 2019Q2. We will use the Fred Stat website and download data on these variables: Seasonally quarterly GDP deflator (GDPDEF): https://fred.stlouisfed.org/series/GDPDEF ht We define inflation as follows: \\[\\pi_t = 400 \\times ln\\left(\\frac{P_t}{P_{t-1}} \\right)\\] Here \\(P_t\\) denotes GDP deflator for quarter \\(t\\). Seasonally adjusted Civilian unemployment rate (UNRATE): https://fred.stlouisfed.org/series/UNRATE Effective federal funds rate (FEDFUNDS): https://fred.stlouisfed.org/series/FEDFUNDS The first step in any VAR analysis is to ensure that all variables in the model are stationary. Although not reported here, I find that inflation is stationary whereas unemployment and interest rate are first difference stationary. Accordingly, we will use inflation and first differences of unemployment and interest rate in our VAR analysis. The second step in the VAR analysis is to determine the optimal number of lags. Table 7.1 presents different information criteria for up to 8 lags. Using SC criterion we select optimal lags to be 2. Table 7.1: Lag selection for VAR model Hence, our reduced-form VAR model is given by: \\[ \\pi_t = a_{10} + a_{11} \\pi_{t-1} + a_{12} u_{t-1} + a_{13} i_{t-1} + b_{11} \\pi_{t-2} + b_{12} u_{t-2} + b_{13} i_{t-2} + e_{1t}\\] \\[ u_t = a_{20} + a_{21} \\pi_{t-1} + a_{22} u_{t-1} + a_{23} i_{t-1}+ b_{21} \\pi_{t-2} + b_{22} u_{t-2} + b_{23} i_{t-2} + e_{2t}\\] \\[ i_t = a_{30} + a_{31} \\pi_{t-1} + a_{32} u_{t-1} + a_{33} i_{t-1}+ b_{31} \\pi_{t-2} + b_{32} u_{t-2} + b_{33} i_{t-2}+ e_{3t}\\] We can estimate the above model using OLS for each equation separately. It is a common practice to report the variance decomposition and impulse response from an estimated VAR model instead of reported the estimated coefficients for each equation. I will follow that convention and only report the analysis based on the estimated VAR model. The table below shows the results of Granger-causality test using optimal lag of 2. We find that inflation Granger-causes ffr and unemployment as indicated by a low p-value for the null hypothesis of no Granger-causality. Similarly, unemployment Granger-causes inflation and ffr. Finally, ffr also Granger-cause other two variables. ## ## Granger causality H0: inf do not Granger-cause u ffr ## ## data: VAR object varmodel ## F-Test = 3.9185, df1 = 4, df2 = 738, p-value = 0.003718 ## ## Granger causality H0: u do not Granger-cause inf ffr ## ## data: VAR object varmodel ## F-Test = 1.8588, df1 = 4, df2 = 738, p-value = 0.1158 ## ## Granger causality H0: ffr do not Granger-cause inf u ## ## data: VAR object varmodel ## F-Test = 5.2338, df1 = 4, df2 = 738, p-value = 0.0003679 Next we present the impulse responses for the recursive VAR structure where we use the following ordering: inflation, unemployment, and interest rate. For brevity, I only show the effect of an unexpected increase in ffr on all three variables as this shock propagates through the recursive VAR structure using the estimated coefficients from the reduced-form VAR model. From Figures 7.1 through 7.3 we observe a persistent positive effect of higher interest rate on both unemployment and inflation that fades over time. Figure 7.1: Impulse Response Function Figure 7.2: Impulse Response Function Figure 7.3: Impulse Response Function Next we present the forecast error variance decomposition results that decomposes the variance in forecast error of a variable into own contribution and contribution of shocks to other variables. In Table below we show this analysis at 4 forecast horizons, namely, 1 period, 4 period, 8 period, and 12 periods. They suggest considerable interaction among the variables. For example, at the 12-quarter horizon, 63 percent of the forecast error variance in for ffr can be attributed to the inflation and unemployment shocks in the recursive VAR. In contrast, only 15 percent of the forecast error variance for inflation comes from shocks to ffr and unemployment. Table 7.2: Panel A-FEVD for Inflation horizon inf u ffr 1 1.000 0.000 0.000 4 0.949 0.002 0.048 8 0.940 0.003 0.057 12 0.937 0.004 0.059 Table 7.2: Panel B- FEVD for Unemployment horizon inf u ffr 1 0.077 0.923 0.000 4 0.070 0.916 0.014 8 0.068 0.918 0.015 12 0.062 0.902 0.037 Table 7.2: Panel C- FEVD for FFR horizon inf u ffr 1 0.016 0.061 0.923 4 0.044 0.102 0.854 8 0.141 0.092 0.767 12 0.231 0.079 0.689 Finally, we can use our reduced-form VAR estimation to produce forecasts for each variable in the model. Figure 7.4 below provides forecast for next 8 quarters from 2019Q3 through 2021Q2. These forecasts can be compared with univariate forecast for each variable using ARIMA or some other method to assess the improvement in forecast accuracy due to estimating a VAR model. Figure 7.4: Forecast for 2019Q3 through 2021Q2 "],["modeling-volatility.html", "Chapter 8 Modeling Volatility 8.1 Some stylized facts about stock market volatility 8.2 ARCH(q): Autoregressive Conditional Heteroscedasticiy of order \\(q\\) 8.3 GARCH(p,q): Generalized Autoregressive Conditional Heteroscedasicity of order \\(p\\) and \\(q\\) 8.4 Extensions of standard GARCH model 8.5 Application of GARCH model: Estimating volatility of SP500 return", " Chapter 8 Modeling Volatility Consider a stock market analyst who is interested in finding out whether to invest in a particular stock or not. What kind of variables will govern her choice? If we focus on modern portfolio theory (MPT), a benchmark model in finance, a rational investor only cares about two variables: expected return from a financial asset such as a stock risk or volatility underlying this asset Let \\(P_t\\) denotes the adjusted closing price for a stock traded in the market. The continually compounded return of this stock is given by: \\[y_t=[log(P_t)-log(P_{t-1})]\\times 100\\] According to the MPT as an investor you should care about: \\(E(y_{t+h}|\\Omega_t)\\): this is the expected return on the asset, given information at time t \\(Var(y_{t+h}|\\Omega_t)\\): this is the expected volatility or risk underlying this asset, given the information at time t. Note that even though this example is using stock market as the motivation, the same is true for any other time series of interest. I use stock market as an example because here the variance has an intuitive appeal as risk underlying an asset. Thus far our discussion has focused on modeling the conditional mean of a given time series. For example, consider the following \\(ARMA(1,1)\\) model for the stock market return: \\[y_t=\\phi_0 + \\phi_1 y_{t-1} + \\theta_1 \\epsilon_{t-1} + \\epsilon_t ; \\quad \\epsilon_t\\sim WN(0, \\sigma^2_\\epsilon )\\] From this model, we can obtain the forecast for \\(y_{t+h}\\) as the conditional mean of \\(y_t\\) given the information available at time \\(t\\): \\[f_{t,h}=E(y_{t+h}|\\Omega_t)\\] In this sense ARMA models are inherently models for the conditional mean of a stationary time series. Going back to our stock market example, this ARMA model can give us information about how the expected return on a stock will evolve over time. An important assumption we make in estimating this model is that the error term is homoscedastic, i.e, the error term has a constant variance across observations. However, often this assumption will not be satisfied in data. More importantly in some cases, such as our current example of stock market, making this assumption is conceptually incorrect. This is because in our example, assuming constant variance is equivalent to assuming constant risk underlying a stock. Such an assumption is clearly not desirable for an investor. Hence, we now need a class of models where \\(Var(y_t|\\omega_t)\\) are not constant over time. Formally, our object of interest in this topic is the conditional variance of a time series, \\(y_t\\): \\[\\sigma_t^2=Var(y_t|\\Omega_t)\\] 8.1 Some stylized facts about stock market volatility Before proceeding with formally modeling the conditional variance of a time series, let us establish some stylized facts about financial assets, such as a stock. Below I plot the daily return for SP500 along with its ACF (see Figure 1A and 1B). Using squared returns as a proxy for variance, I also plot squared returns for SP500 and its ACF (see Figure 2A and 2B). Focusing on the volatility, the plot of squared returns and its ACF establishes the following stylized facts: From Figure 2A, we observe that large values of squared returns cluster together, and small values of squared returns cluster together. That is periods of high volatility are followed by periods of high volatility and periods of low volatility are followed by periods of low volatility. This phenomenon is known as volatility persistence or volatility clustering in the fields of economics and finance. A more direct evidence for volatility persistence can be inferred from the ACF plot of squared returns. From Figure 2B, we observe a strong positive serial correlation in squared returns. Hence, it is reasonable to assume that the variance of a financial time series may not be constant over time. Next we learn two classes of models that have been suggested to model conditional variance of a time series. 8.2 ARCH(q): Autoregressive Conditional Heteroscedasticiy of order \\(q\\) Engle (1982) proposed a non-linear model for the conditional variance of a stationary time series where past squared shocks affect current volatility. For simplicity, let us assume that we are not interested in modeling the mean of the time series. Hence, our model for the mean is a constant value, \\(\\mu\\). Then, an \\(ARCH(1)\\) model can be specified as follows: \\[\\text{Mean Model:} \\quad y_t = \\mu +\\epsilon_t \\quad \\text{where} \\ \\epsilon_t=\\nu_t \\sigma_t \\ \\text{and} \\ \\nu_t\\sim N(0,1)\\] \\[\\text{Variance Model:} \\quad \\sigma_t^2=\\omega +\\alpha_1 \\epsilon_{t-1}^2 \\text{where} \\ \\omega&gt;0 \\ \\text{and} \\ \\alpha_1&gt;0 \\] In this model the unconditional variance of the time series is constant, but the conditional variance depends on the past squared error term. The variance model can be easily generalized to include \\(q\\) past shocks which gives us \\(ARCH(q)\\) \\[\\text{Variance Model:} \\quad \\sigma_t^2=\\omega +\\alpha_1 \\epsilon_{t-1}^2+\\alpha_2 \\epsilon_{t-2}^2 +\\alpha_3 \\epsilon_{t-3}^2 +...+ \\alpha_q \\epsilon_{t-q}^2 \\] \\[\\text{where} \\ \\omega&gt;0 \\ \\text{and} \\ \\alpha_i&gt;0 \\ \\forall \\ i\\] 8.3 GARCH(p,q): Generalized Autoregressive Conditional Heteroscedasicity of order \\(p\\) and \\(q\\) A generalization of the above ARCH model was proposed by Bolerslev (1986) where the conditional variance in the current period depend on past squared shocks as well as past observations of the conditional variance. This model is known as \\(GARCH\\) which stands for generalized ARCH model. Formally, the variance equation of a \\(GARCH(1,1)\\) is given by: \\[\\quad \\sigma_t^2=\\omega +\\alpha_1 \\epsilon_{t-1}^2 +\\beta_1 \\sigma^2_{t-1} \\quad \\text{where} \\ \\omega&gt;0, \\ \\alpha_1&gt;0, \\ \\text{and} \\ \\beta_1&gt;0 \\] In practice most models of volatility now use some version of GARCH(1,1) as it provides a more parsimonious model of volatility when compared to an ARCH(q) model. Following are few important properties of a standard GARCH(1,1) model: Unconditional variance: The unconditional variance of \\(y_t\\) is still constant due to stationarity and is given by: \\[\\sigma^2_y = \\frac{\\omega}{1-\\alpha_1-\\beta_1}\\] Volatility persistence: the persistence is given by \\(\\alpha_1+\\beta_1\\). Half-life measure: is the number of periods it takes for the estimated volatility to converge to half of the unconditional variance of the time series. 8.4 Extensions of standard GARCH model There are two issues with the standard GARCH model that merits more discussion: In the standard GARCH framework, the effect of past shocks on volatility is symmetric. That is whether the observed shock is negative or positive, the effect on the volatility is the same. However, in the financial market another stylized fact is the asymmetric response of volatility to news. For instance, it is quite common to find that negative news increases volatility more than the reduction in volatility caused by positive news. One analytical tool to illustrate this point is the news impact curve where we plot the shock on the x-axis and estimated/predicted volatility from our GARCH model on the y-axis. Below I plot three types of news impact curves. In the first case, the curve is symmetric: negative and positive shocks have identical effect on volatility. In the second case, negative news has a bigger effect on volatility, and finally in the third case, positive news has a bigger effect on volatility. Because these models are models of variance which cannot be negative, the estimation of these models imposes non-negativity condition on all estimated parameters. For instance, in \\(GARCH(1,1)\\) we assume that \\(\\omega, \\alpha_1, \\ \\text{and} \\ \\beta_1\\) are all positive. 8.4.1 GJR-GARCH(1,1) Glosten, Jagannathan, and Runkle (1993) proposed a variation of the standard GARCH model that incorporates the asymmetry of the impact of news on volatility. The resulting model is called GJR-GARCH and it addresses the first of the issues listed above. Formally, the variance equation of the GJR-GARCH(1,1) is given by: \\[ \\sigma_t^2=\\omega+\\alpha_1 \\epsilon^2_{t-1}+\\beta_1 \\sigma^2_{t-1}+\\gamma_1 D_{t-1}\\epsilon^2_{t-1}\\] where \\(D_{t-1}=1\\) if \\(\\epsilon_{t-1}&lt;0\\) and \\(0\\) otherwise. Hence, now the effect of \\(\\epsilon^2_{t-1}\\) on volatility is \\(\\alpha_1+\\gamma_1\\) for negative shocks and \\(\\alpha_1\\) for positive shocks. The news impact curve from this model will be asymmetric. The persistence from this model will also be affected by \\(\\gamma_1\\). Specfically for the GJR-GARCH(1,1) model, Persistence: \\(\\alpha_1+\\beta_1 +\\frac{\\gamma_1}{2}\\) Unconditional variance: \\[\\sigma^2_y = \\frac{\\omega}{1-\\alpha_1-\\beta_1-\\frac{\\gamma_1}{2}}\\] 8.4.2 Exponential GARCH or EGARCH(1,1) Exponential GARCH model by Nelson (1991) accounts for both the issues outlined above. It allows for asymmetric effects of shocks and also does not require the non-negativity constraints. More importantly, it also accounts for different effect of shocks of different magnitude, and hence provides an estimate of the size effect. Formally, the variance equation for EGARCH(1,1) is given by: \\[ln(\\sigma^2_{t-1})=\\omega+ \\alpha_1 z_{t-1} +\\gamma_1 (|z_{t-1}|-E|z_{t-1}|) +\\beta_1\\sigma^2_{t-1}\\] where \\(z_t=\\frac{\\epsilon_t}{\\sigma_t}\\) is the standardized error term. Here, \\(\\alpha_1\\) captures the sign effect and \\(\\gamma_1\\) captures the size effect. A common finding is that negative news and larger shocks have bigger effect on volatility. Accordingly, we often find in empirical applications of EGARCH that \\(\\alpha_1&lt;0\\) and \\(\\gamma_1&gt;0\\). For this model, we have Persistence: \\(\\beta_1\\) Unconditional variance: \\[\\sigma^2_y = \\frac{\\omega}{1-\\beta_1}\\] 8.5 Application of GARCH model: Estimating volatility of SP500 return In this application, we will estimate the volatility underlying SP500 returns (Figure 1A and Figure 2A). The first step is to test whether squared returns have ARCH effects i.e, whether there is any evidence for time-varying volatility in our data. For this purpose we will use Engle’s ARCH test. Consider our constant mean model: \\[y_t=\\mu +\\epsilon_t\\] We can estimate the above model by OLS and obtain residuals \\(e_t=y_t-\\hat{y_t}\\). The test for ARCH effects is based on the idea that if there is conditional hetroscedasiticity in our data then the squared residuals will have serial correlation. The ARCH test involves estimating the following regression: \\[e^2_t= \\beta_0 +\\beta_1 e^2_{t-1} + \\beta_2 e^2_{t-2}+...+ \\beta_p e^2_{t-p} + u_t\\] Then, the test for ARCH effects is given by: \\[H_0: \\beta_1=\\beta_2=...=\\beta_p=0 \\ \\Rightarrow \\text{no ARCH effects}\\] \\[ H_A: \\text{Not} \\ H_0\\] In R, we use a package called aTSA to implement this test.The function is called arch.test(). Figure 7.1 below shows the results of this test for our data. library(aTSA) library(forecast) fit=arima(y, c(0,0,0)) arch.test(fit) ## ARCH heteroscedasticity test for residuals ## alternative: heteroscedastic ## ## Portmanteau-Q test: ## order PQ p.value ## [1,] 4 2085 0 ## [2,] 8 3788 0 ## [3,] 12 5097 0 ## [4,] 16 5715 0 ## [5,] 20 6257 0 ## [6,] 24 6627 0 ## Lagrange-Multiplier test: ## order LM p.value ## [1,] 4 2269 0 ## [2,] 8 900 0 ## [3,] 12 575 0 ## [4,] 16 411 0 ## [5,] 20 325 0 ## [6,] 24 262 0 Figure 8.1: ARCH LM test We find strong evidence for ARCH effects in our data as the null hypothesis of no ARCH effects is rejected at different orders of serial correlation in squared residuals. Next we estimate three types of GARCH(1,1) models using the rugarch package. Tables 7.1A-7.1D below show the estimated parameters of these three models. The news impact curve for these 3 classes of GARCH model are plotted in Figure 2-4 below. Finally, the estimated conditional volatility from the three models are plotted along with the return in Figures 5-7. We find that there is strong evidence for the sign effect with negative news having a bigger effect on volatility as indicated by the positive value for \\(\\gamma_1\\) in GJR-GARCH and negative value of \\(\\alpha_1\\) in EGARCH. Further, in the EGARCH model we find evidence for the size effect as indicated by positive value for \\(\\gamma_1\\). These findings are confirmed by the asymmetric news impact curves for the GJR-GARCH and EGARCH models. Table 8.1: (A) Estimated GARCH(1,1) Estimate Std. Error t value Pr(&gt;|t|) mu 0.072 0.012 5.920 0 omega 0.030 0.004 7.729 0 alpha1 0.145 0.012 11.799 0 beta1 0.836 0.012 68.864 0 Table 8.1: (B) Estimated GJR-GARCH(1,1) Estimate Std. Error t value Pr(&gt;|t|) mu 0.034 0.012 2.832 0.005 omega 0.030 0.004 8.199 0.000 alpha1 0.019 0.010 1.936 0.053 beta1 0.857 0.013 67.214 0.000 gamma1 0.197 0.020 9.963 0.000 Table 8.1: (C) Estimated EGARCH(1,1) Estimate Std. Error t value Pr(&gt;|t|) mu 0.031 0.008 3.766 0.000 omega 0.004 0.003 1.494 0.135 alpha1 -0.149 0.010 -14.809 0.000 beta1 0.968 0.004 267.943 0.000 gamma1 0.185 0.016 11.478 0.000 Table 8.1: (D) Persistence, Unconditional Variance, and Half-life GARCH(1,1) GJR-GARCH(1,1) EGARCH(1,1) Persistence 0.980 0.974 0.968 Unconditional Variance 1.533 1.157 1.133 Half-life 35.196 26.806 21.034 Finally, these models can also be used to forecast the volatility of SP500. Figure 8 below shows this forecast for the next 7 days from the EGARCH(1.1) model. "],["review-of-serial-correlation-and-heteroscedasticity.html", "A Review of Serial Correlation and Heteroscedasticity A.1 Classical Assumptions A.2 Heteroscedasticity A.3 Testing for Hetroscedasticity in data A.4 Serial correlation A.5 Testing for Serial Correlation in data", " A Review of Serial Correlation and Heteroscedasticity A.1 Classical Assumptions Similar to our discussion in chapter 2, a desirable sample estimator must be unbiased and efficient. The discussion so far has focused on estimating regression parameters using sample data on the dependent and the independent variables. We will now focus on the conditions under which the OLS estimator of regression parameters are unbiased and efficient. Suppose we have the following regression model: \\[Y_i = \\beta_0 + \\beta_1 X_i+ \\epsilon_i\\] In the above model, \\(\\beta_0\\) and \\(\\beta_1\\) denote true but unknown population parameters of interest. We can use a sample data for \\(Y_i\\) and \\(X_i\\) to compute sample estimators for these two parameters. OLS is one such method of obtaining sample estimators \\(\\hat{\\beta_0}\\) and \\(\\hat{\\beta_1}\\). For these OLS estimators to be unbiased and efficient we need: Unbiasedness: \\[E(\\hat{\\beta_0)}=\\beta_0 \\ \\text{and} \\ E(\\hat{\\beta_1)}=\\beta_1\\] Efficiency: \\[Var(\\hat{\\beta_0}) \\ \\text{and} \\ Var(\\hat{\\beta_1}) \\ \\text{are smallest possible.} \\] In order for the OLS estimators to be unbiased and efficient, we need a set of assumptions to be satisfied. These assumptions are known as classical assumptions and the result is formally known as the Gauss-Markov theorem named after two mathematicians, namely, Carl Gauss and Andrey Markov. Theorem A.1 (Gauss-Markov theorem) The OLS estimator is the best linear and unbiased estimator (BLUE) if and only if the following six classical assumptions are satisfied: The regression model is linear in parameters. There is no linear relationship between included independent variables in the regression model or there is no perfect multicollinearity. The expected value of the regression error term is 0. \\[E(\\epsilon_i)=0 \\ \\text{for all} \\ i\\] There is no heteroscedasticity, i.e, the variance of the regression error term is constant. \\[Var(\\epsilon_i)=\\sigma^2 \\ \\text{for all} \\ i\\] There is no serial correlation. In time series data serial correlation implies observations of a variable are correlated over time. This is also known as auto-correlation. One of the classical assumption is that there is no serial (or auto) correlation in regression error terms.\\[Cor(\\epsilon_t, \\epsilon_{t-s})=0 \\ \\text{where} \\ t\\neq s\\] Note that for cross-sectional data correlation in error terms across observations is known as spatial correlation. In this course we will abstract away from this type of correlation and focus only on the serial correlation in time series data. No endogeneity problem, i.e, all included independent variables in the model are exogenous and hence are uncorrelated with the regression error terms. \\[Cor(X_{ki}, \\epsilon_i) = 0 \\ \\text{for} k=1,2,3, .., K\\ \\] Of these 6 assumptions, in practice, we often take assumptions 1 through 3 for granted and do not consider violations of these assumptions in our data. However, assumptions 3 to 6 are often not met in data and are investigated much more rigorously. Accordingly, in this chapter we will focus on heteroscedasticity, serial correlation, and no endogeneity. A.2 Heteroscedasticity One of the main assumptions that affect the efficiency of the OLS estimator is the assumption of no heteroscedasticity which forces a constant variance for the error term in our regression model. Consider the following simple regression model that explains food expenditure (\\(Y\\)) based on a person’s disposable income (\\(X\\)): \\[Y_i=\\beta_0 + \\beta_1 X_i + \\epsilon_i\\] The classical assumption of no heteroscedasticity (or Homoscedasticity) implies that \\(Var(\\epsilon_i)=\\sigma^2_\\epsilon\\). In the context of our example, this assumption can be interpreted as follows. The information a person’s income has for his food expenditure does not vary by the any characteristic of this person (say income). As a result the range of errors we can make in predicting someone’s food expenditure based on their income stays constant. Graphically, if error term are homoscedastic then there is no relationship between the range of errors we can make and a person’s income. Graphically, Figure 6.1 below shows this pattern–whether we look at observations with low income or those with high income, the range of errors we make is more or less constant. Figure A.1: Homoscedastic Errors However, it is reasonable to argue that the value of information differ across observations in the following sense. Some observations have a greater role in reducing error variance than others. In our example, one can argue that food expenditure forms a bigger percent of a person with lower income than one with higher income who may use his income for non-food expenditure activities. In this case we would expect that the variance of errors will increase as income increases. This particular pattern of heteroscedastic errors is shown in Figure 6.2 below. Figure A.2: Heteroscedastic Errors In general the exact form of heteroscedasticity will depend on the nature of the problem at hand. However, whether or not heteroscedasticity is present in our data is an empirical question. A.2.1 Consequences of Heteroscedasticity for the OLS estimator Presence of heteroscedasticity is a violation of the classical assumption and accordingly will affect the properties of the OLS estimator. In general, if there is heteroscedasticity in data then: The OLS estimator of each \\(\\beta\\) coefficient is still unbiased. However, due to ignoring the systematic variation in the error term, the OLS estimator is no longer efficient and the sample estimators of the standard errors of each \\(\\beta\\) is incorrect. Consequently, we cannot conduct hypothesis testing on regression coefficients using the OLS estimator. A.3 Testing for Hetroscedasticity in data The first step for incorporating heteroscedasticity in our estimation is to test for its presence in our sample data. This test is based on OLS residuals of the original regression model and accounts for both linear and non-linear forms of heteroscedasticity. Consider the following regression model with two independent variables: \\[Y_i=\\beta_0 + \\beta_1 X_{1i} + \\beta_2 X_{2i} + \\epsilon_i\\] Using OLS we can obtain the residuals from this model, denoted by \\(e_i\\). Next, we will use this residual data to test for the presence of heteroscedasticity. A.3.1 LM test for linear heteroscedasticity: BP test The first test of heteroscedasticity is the Breusch-Pagan (BP) test of linear heteroscedasticity. The procedure for implementing this test is detailed below: Step 1. Estimate the regression model using OLS and obtain residuals: \\(e_i\\) Step 2: Estimate the BP regression model where the dependent variable is squared residuals and all independent variables are included on the right hand side: \\[e^2_i=\\alpha_0 + \\alpha_1 X_{1i} + \\alpha_2 X_{2i} + \\epsilon_i\\] Obtain \\(R^2\\) from this regression and denote it by \\(R^2_{BP}\\). Step 3: The test of linear Heteroscedasticity is given by- \\[H_0: \\alpha_1=\\alpha_2=0 \\Rightarrow \\text{No linear heteroscedasticity}\\] \\[H_A: Not \\ H_0 \\Rightarrow \\text{linear heteroscedasticity}\\] The test statistic id denoted by \\(LM\\) and the formula is given by: \\[LM=R^2_{BP} \\times N\\] where \\(N\\) denotes sample size. Under the null hypothesis this test statistic follows Chi-square distribution with \\(J\\) degrees of freedom, where \\(J\\) denotes number of independent variables in the BPG regression of Step 2. If the LM test statistic is greater than the critical value from the Chi-square distribution, we reject the null hypothesis and conclude that there is sample evidence for linear heteroscedasticity. A.3.2 LM test for linear heteroscedasticity: White’s test We can also test for the presence of non-linear heteroscedasticity using White’s test. The procedure for implementing this test is detailed below: Step 1. Estimate the regression model using OLS and obtain residuals: \\(e_i\\) Step 2: Estimate the BPG regression model where the dependent variable is squared residuals. Now, independent variables include all independent variables, squared of all independent variables, and their product. So for example with 2 independent variables \\(X_1\\) and \\(X_2\\) we get the following White regression: \\[e^2_i=\\alpha_0 + \\alpha_1 X_{1i} + \\alpha_2 X_{2i} + \\alpha_3 X^2_{1i} + \\alpha_4 X^2_{2i}+\\alpha_5 (X_{1i}\\times X_{2i})+ \\epsilon_i\\] Obtain \\(R^2\\) from this regression and denote it by \\(R^2_{White}\\). Step 3: The test of Hetroscedasticity is given by- \\[H_0: \\alpha_1=\\alpha_2=\\alpha_3=\\alpha_4=\\alpha_5=0 \\Rightarrow \\text{No heteroscedasticity}\\] \\[H_A: Not \\ H_0 \\Rightarrow \\text{heteroscedasticity}\\] The test statistic id denoted by \\(LM\\) and the formula is given by: \\[LM=R^2_{White} \\times N\\] where \\(N\\) denotes sample size. Under the null hypothesis this test statistic follows Chi-square distribution with \\(J\\) degrees of freedom, where \\(J\\) denotes number of independent variables in the White regression of Step 2. If the LM test statistic is greater than the critical value from the Chi-square distribution, we reject the null hypothesis and conclude that there is sample evidence for heteroscedasticity. Example A.1 (Testing for Hetroscedasticity) One of the most important models in finance is the Fama-French 3-factor model of risk premium of a stock. As per this model, the expected return on an asset over and above a risk free rate depends on depends on three factors: Market risk: Market return minus risk free rate Size premium: small market captilization stocks tend to out perform large market capitalization stocks. This variable captures this permium. Value premium: Stocks with high book-to-market value out perform those with low value. This variable in this sense captures the value premium. The regression model implied is given by: \\[y_t= \\beta_0 + \\beta_1 X_{1t} + \\beta_2X_{2t} + \\beta_3 X_{3t} + \\epsilon_t\\] Here, \\(y_t\\) is the return on a stock minus the risk free rate. In this example we will use IBM stock and proxy risk free rate by using return on 1 month TB. \\(X_{1t}\\) denotes market risk, \\(X_{2t}\\) denotes size premium, and \\(X_{3t}\\) denotes value risk. The data for these three factors is downloaded from the following website: https://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html In this application we use monthly data from Jan-2007 through June 2019. Table A.1 provides the estimation of this model using OLS.   Dependent variable: (Return on IBM-Risk Free Rate) Explanatory Variables b s.e.(b) t-ratio p-value Intercept -0.054 *** 0.010 -5.245 &lt;0.001 Market Risk Premium 0.014 *** 0.002 6.083 &lt;0.001 Size Premium 0.006 0.007 0.851 0.396 Volume Premium -0.012 0.006 -1.943 0.054 Observations 150 R2 / R2 adjusted 0.215 / 0.199 log-Likelihood 101.354 p&lt;0.05   ** p&lt;0.01   *** p&lt;0.001 Table A.1: OLS Estimation of Fama-French 3-factor model In order to use the OLS estimator for hypothesis testing, we need to confirm whether there is heteroscedasticity in our data. For this example the BP test regression is given by: \\[e^2_i=\\alpha_0 + \\alpha_1 f_{1i} + \\alpha_2 f_{2i} +\\alpha_3 f_{3i} + \\epsilon_i\\] The null hypothesis for no heteroscedasticity requires \\(\\alpha_1=\\alpha_2=\\alpha_3=0\\). The White test regression is given by: \\[e^2_i=\\alpha_0 + \\alpha_1 f_{1i} + \\alpha_2 f_{2i} +\\alpha_3 f_{3i} + \\alpha_4 f^2_{1i} +\\alpha_5 f^2_{2i} + \\alpha_{6}f^2_{3i} + \\alpha_7 (f_{1i} \\times f_{2i})+ \\alpha_8 (f_{1i} \\times f_{3i})+ \\alpha_9 (f_{2i} \\times f_{3i})+\\epsilon_i\\] The null hypothesis for no heteroscedasticity requires \\(\\alpha_1=\\alpha_2=\\alpha_3=\\alpha_4=\\alpha_5=\\alpha_6=\\alpha_7=\\alpha_8=\\alpha_9=0\\). We conduct both BP and White’s test in R and present the results in Table A.2. We find that there is evidence of heteroscedasticity according to both tests, as we reject the null hypothesis for BP test at 5% level of significance and we reject the null hypothesis for White’s test at 10% level of significance. BP test White’s test LM statistic 10.099 15.396 p-value 0.018 0.081 Table A.2: Two tests of heteroscedasticity A.4 Serial correlation In time series data it is common to observe correlation across observations over time. Indeed many relationships in economics are dynamic in nature. For example, consumption habits indicate past consumption has an effect on current consumption. Similarly, production activities typically stretch over multiple periods and output in one period is often affect by the level produced in the previous period. As these examples indicate it is reasonable to argue that time series economic data may exhibit some kind of serial correlation. The correlation between observations of a time series variable is captured by the autocorrelation function (ACF) which is given by: \\[ACF(s)=\\frac{Cov(y_t, y_{t-s})}{\\sigma_{y_t} \\times \\sigma_{y_{t-s}}}\\] Note that here \\(t\\) indexes the current period and \\(s\\) is an integer. For example, if \\(s=1\\), we are looking at correlation between \\(y_{t}\\) and \\(y_{t-1}\\). This is known as first order serial correlation. Similarly, for \\(s=2\\), we get the second order serial correlation between \\(y_{t}\\) and \\(y_{t-2}\\). In this ACF is a function of \\(s\\) and will give us a series of values of correlation of the current period with \\(s\\) past periods. One of the main assumptions that affect the efficiency of the OLS estimator is the assumption of no serial correlation which forces the error term in our regression model to be independent across observations over time. Consider the following simple regression model: \\[Y_t=\\beta_0 + \\beta_1 X_t + \\epsilon_t\\] The classical assumption of no serial correlation implies that \\(Cor(\\epsilon_t,\\epsilon_{t-s})=0\\), where \\(t\\) indexes current time period and \\(s\\) is an integer. However, it is quite possible that the regression errors are actually correlated over time. For simplicity, lets assume that the error term in our model has first order serial correlation of the following form: \\[\\epsilon_t = \\rho \\epsilon_{t-1} + u_t\\] Here \\(\\rho\\) captures the first order serial correlation and is the slope parameter. \\(u_t\\) is a classical error term that satisfies all classical assumptions and hence is serially uncorrelated by definition. Now, depending on the sign of \\(\\rho\\) the serial correlation can be positive or negative. In economics it is most common to observe positive serial correlation where the persistence in data ensures that a positive (negative) value of the regression error in one period is likely to be followed by another positive (negative) value. In contrast for negative serial correlation a positive error in one period is more likely to be followed by a positive error next period, and vice-versa. Figure A.3 below shows the pattern of residuals for the two cases of positive and negative serial correlation in the regression error terms. Figure A.3: Serially correlated Errors In general we can have higher order serial correlation in data and whether or not there is such correlation in our data is an empirical question. A.4.1 Consequences of Serial Correlation for the OLS estimator Presence of serial correlation is a violation of the classical assumption and accordingly will affect the properties of the OLS estimator. In general, if there is serial correlation: The OLS estimator of each \\(\\beta\\) coefficient is still unbiased. However, the OLS estimator is no longer efficient and the sample estimators of the standard errors of each \\(\\beta\\) is incorrect. Consequently, we cannot conduct hypothesis testing on regression coefficients using the OLS estimator. A.5 Testing for Serial Correlation in data A.5.1 Breusch-Godfrey (BG) LM test for serial correlation In order to test for higher order serial correlations we can use the BG test which uses the OLS residuals to test for evidence of serial correlation. The procedure for this test is described below: Step 1. Estimate the regression model using OLS and obtain residuals: \\(e_t\\) Step 2: Estimate the BG regression model where the dependent variable is the residuals and independent variables are all X variables in the model, and lagged values of this residual. The number of lagged residuals capture the order of serial correlation. In general for testing serial correlation up to order of \\(p\\), we will estimate the following regression: \\[e_t=\\alpha_0 + \\gamma_1 c\\cdot X_{1t}+ \\gamma_2 \\cdot X_{2t}+...+\\gamma_K \\cdot X_{kt}+ \\alpha_1 e_{t-1} + \\alpha_2 e_{t-2} +...+ \\alpha_p e_{t-p} + u_t\\] Denote \\(R^2_{BG}\\) as the R-squared of this regression model. Step 3: The serial correlation test is given by: \\[H_0: \\alpha_1=\\alpha_2=\\alpha_3=....=\\alpha_p=0\\] \\[H_A: Not \\ H_0\\] The LM test statistic is given by: \\[LM=N\\times R^2_{BG}\\] Under the null hypothesis, this test statistic follows Chi-square distribution with \\(p\\) degrees of freedom. If LM statistic is bigger than the critical value, we reject the null and conclude that there is serial correlation. Example A.2 (Testing for serial correlation) Let us use the same example as the one we used for testing hetroscedasticity. We estimated a three factor model for the stock return of Apple using use monthly data from Jan-2007 through June 2019 (see Table A.1 for OLS estimation results of this model). We can implement both tests for serial correlation in R using the lmtest package. Table A.3 below presents the results test-statistic for both serial correlation tests. For comparison, I am testing for first order serial correlation. the BG test clearly indicates presence of serial correlation as indicated by a p-value which is less than 0.05. For Durbin-Watson test, sample size is 150 and K=3. Using the Durbin-Watson table we get dL=1.584 and dU=1.665. Because d=0.75 is less than dL, we reject the null hypothesis of no serial correlation and conclude there is evidence for positive first order serial correlation. BG test Test statistic 53.623 p-value 0.000 Table A.3: Two tests of Serial Correlation "],["review-of-differential-calculus-and-optimization.html", "B Review of Differential Calculus and Optimization B.1 Derivative of a single variable function B.2 Second derivative and non-linearity B.3 Partial derivatives: Multi-variable functions B.4 Optimization Problems", " B Review of Differential Calculus and Optimization Given that all students must have taken a course in calculus before enrolling for this class, it is assumed that everyone in the class is comfortable with concepts such as derivatives, partial derivatives, and optimization. In this chapter, I will provide a brief review of some concepts that are most pertinent for Econometrics. I strongly encourage that you read your lecture notes for Calculus if you find it difficult to follow the material presented in this chapter. B.1 Derivative of a single variable function Definition B.1 (Derivative of a function) Consider the following function, \\(y=f(x)\\). The derivative of this function measures the rate of change in \\(y\\) caused by a change in \\(x\\). There are two alternative notations for the derivative of \\(y\\) with respect to \\(x\\): \\(f&#39;(x)\\) or \\(\\displaystyle{\\frac{dy}{dx}}\\). The derivative of a function is very closely related to the concept of slope of a function. Let \\(\\Delta\\) denotes change in a variable. Then, by definition, the slope of \\(y\\) with respect to \\(x\\) is given by: \\[slope=\\frac{\\Delta y}{\\Delta x}\\] The derivative of \\(y\\) with respect to \\(x\\) is the limit value of the slope as \\(\\Delta x \\rightarrow 0\\). Hence, \\[\\frac{dy}{dx} \\ or \\ f&#39;(x)=\\lim_{\\Delta x \\to 0} \\left( \\frac{\\Delta y}{\\Delta x}\\right) \\] B.1.1 Rules of Differentiation Derivative of a constant is \\(0\\). Derivative of a function multiplied by a constant is constant times the derivative of the function: \\[\\frac{d}{dx} [\\ a\\times f(x)]=a\\times f&#39;(x)\\] where it is assumed that \\(a\\) is an constant. Addition rule: \\[ \\frac{d}{dx} [f(x)+ g(x)]=f&#39;(x)+ g&#39;(x) \\] Subtraction rule: \\[ \\frac{d}{dx} [f(x)- g(x)]=f&#39;(x)-g&#39;(x) \\] Product rule: \\[ \\frac{d}{dx} [f(x)\\times g(x)]= f(x) \\times g&#39;(x) + g(x)\\times f&#39;(x)\\] Quotient rule: \\[ \\frac{d}{dx} \\left[\\frac{f(x)}{g(x)}\\right]=\\frac{f&#39;(x) \\times g(x) - g&#39;(x) \\times f(x)}{g(x)^2}\\] Chain rule: \\[ \\frac{d}{dx} [f(g(x))] = f&#39;(g(x)) \\times g&#39;(x)\\] Derivative of some common functions: Power function: \\(f(x)=x^a\\). Then, \\[f&#39;(x)=a \\times x^{a-1}\\] Natural log function: \\(f(x)=ln(x)\\). Then, \\[f&#39;(x) = \\frac{1}{x}\\] Exponential function: \\(f(x)=e^x\\) \\[f&#39;(x)=e^x\\] B.2 Second derivative and non-linearity Definition B.2 (Second derivative of a function) Consider the following function, \\(y=f(x)\\). The second derivative of this function measures the change in the rate of change of this function. Formally it is denoted by \\(f&#39;&#39;(x)\\) or \\(\\displaystyle{\\frac{d^2y}{dx^2}}\\). The second derivative measures the curvature of the function and hence can be used to distinguish a linear function from a non-linear function. By definition, a linear function has a constant slope implying the its second derivative must be zero. Example B.1 For example, consider the following linear function: \\[f(x) = mx +b\\] Here\\(f&#39;(x)=m\\) and \\(f&#39;&#39;(x)=0\\). A non-linear function will have a non-zero second derivative. There are only two possibilities: \\(f&#39;&#39;(x)&lt;0\\). In this case we have a concave relationship. An example from economics is the production function where the relationship between output and input is concave. \\(f&#39;&#39;(x)&gt;\\). In this case we have a convex relationship. An example from economics is the marginal cost function where the relationship between cost of production and level of output can be convex. B.3 Partial derivatives: Multi-variable functions Ceteris paribus aka holding other things equal is one of the key concepts used in Economic analysis. A partial derivative is a mathematical counterpart of this assumption. Definition B.3 (Partial Derivative) Consider a function of n-variables given by \\(y=f(x_1,x_2, x_3,...,x_n)\\). Then, there are n partial derivatives of this function that can be obtained by taking derivative with respect to one of the \\(x\\)-variables, holding all other constant. Formally, the partial derivative of \\(y\\) with respect to \\(x_i\\) is denoted by \\(\\displaystyle{f_{x_i} \\text{or} \\frac{\\partial y}{\\partial x_i}}\\). Example B.2 Consider the following 3-variable function: \\[y=ln(x_1)+x_1\\times x_2+3x_2^2 + x_1 \\times x_3 + ln(x_3)\\] Then we can compute three partial derivatives of this function: Partial derivative of \\(y\\) with respect to \\(x_1\\), treating \\(x_2\\) and \\(x_3\\) as constants: \\[\\frac{\\partial y}{\\partial x_1} = \\frac{1}{x_1} + x_2+x_3\\] Partial derivative of \\(y\\) with respect to \\(x_2\\), treating \\(x_1\\) and \\(x_3\\) as constants: \\[\\frac{\\partial y}{\\partial x_2} = x_1+6x_2\\] Partial derivative of \\(y\\) with respect to \\(x_3\\), treating \\(x_1\\) and \\(x_2\\) as constants: \\[\\frac{\\partial y}{\\partial x_3} = x_1+ \\frac{1}{x_3}\\] Example B.3 (Cobb-Douglas Production Function) One of the most used functional form for the production function is the Cobb-Douglas production function. Suppose you have two inputs: labor (L) and capital (K). Let Y denotes output. Then, the Cobb-Douglas production function is given by: \\[Y=L^{\\beta_1}K^{\\beta_2}\\] Now, output can change because we change our labor input or our capital input. In each case, we are thinking about a change in output caused by change in one input, holding the other input constant. This is exactly what a partial derivative captures! In what follows next we will use two mathematical concepts to further our understanding of economics of production: Change in natural logs of a variable approximates percent change in that variable. Formally, \\(\\Delta ln(x) \\times 100 \\approx \\text{\\% change in x}\\). Hence, it is often useful to express economic relationships in natural logs. The Cobb-Douglas production function in natural logs is given by: \\[ln(Y)=\\beta_1 \\times ln(L) + \\beta_2 \\times ln(K) \\] The partial derivative of the above equation gives us elasticity of output with respect to each input. Output elasticity of Labor: \\[\\frac{\\% \\ \\text{change in Y}}{\\% \\ \\text{change in L}} = \\frac{\\partial ln(Y) \\times 100}{ \\partial ln(L) \\times 100}=\\beta_1\\] Output elasticity of Capital: \\[\\frac{\\% \\ \\text{change in Y}}{\\% \\ \\text{change in K}} = \\frac{\\partial ln(Y) \\times 100}{ \\partial ln(K) \\times 100}=\\beta_2\\] Note that we can also infer whether production is subject to increasing, decreasing, or constant returns to scale from the numerical values assigned to \\(\\beta_1\\) and \\(\\beta_2\\). Returns to scale is simply the sum of output elasiticities with respect to labor and capital: \\[\\text{Returns to scale}= \\frac{\\% \\ \\text{change in Y}}{\\% \\ \\text{change in L}}+\\frac{\\% \\ \\text{change in Y}}{\\% \\ \\text{change in K}}=\\beta_1+\\beta_2\\] Hence, we obtain constant returns to scale as long as \\(\\beta_1+\\beta_2=1\\). We get decreasing returns to scale if \\(\\beta_1+\\beta_2&lt;1\\). Finally, increasing returns to scale require \\(\\beta_1+\\beta_2&gt;1\\). B.4 Optimization In Economics it is often assumed that rational individuals optimize. For instance, firms seek to maximize profits (or minimize costs) and households seek to maximize utility. Mathematically, this is equivalent to finding extreme values of an objective function. Example B.4 Consider a firm that is choosing a level of output \\((q)\\) to maximize its profits. By definition, profits are total revenue \\(R(q)\\) minus total cost \\(C(q)\\). The resulting profit function \\(\\pi(q)\\) is the firm’s objective function and \\(q\\) is the control variable: \\[\\pi(q)=R(q)- C(q)\\] The firm will choose a value of \\(q\\) that will maximize its profits. Mathematically, this can be written as: \\[ \\max_{q} \\pi(q)\\] One way to solve this problem, is to assume a functional form for profits and evaluate this function for all possible values of \\(q\\). Then, select the value of \\(q\\) that yields highest value for profits. This approach is called numerical optimization and is often used for complicated objective functions. But in many cases, we can use calculus and obtain an analytical solution for the optimization problem. Formally, suppose the objective function is denoted by \\(f(x)\\) and assume that this function is continuous and twice differentiable. Then, \\(x^*\\) is a maximizer if \\(f(x^*)\\geq f(x)\\) for all \\(x\\neq x^*\\). Note that at this point the slope of the tangent to the function is \\(0\\), i.e., \\(f&#39;(x^*)=0\\). This is the first order condition (foc) for obtaining a maximum. The graph below illustrates the maximum of a generic function. Note that the slope of the function changes sign from positive to negative around \\(x^*\\). This will give us the second order condition for obtaining a maximum. \\(x^*\\) is a minimizer if \\(f(x^*)\\leq f(x)\\) for all \\(x\\neq x^*\\). Note that at this point the slope of the tangent to the function is \\(0\\), i.e., \\(f&#39;(x^*)=0\\). This is the first order condition (foc) for obtaining a minimum. The graph below illustrates the minimum of a generic function. Note that the slope of the function changes sign from negative to positive around \\(x^*\\). This will give us the second order condition for obtaining a minimum. Note for a maximum, Similarly, . We can now outline the steps for computing a maximum or minimum of a given function. First-order condition: Compute the first derivative of the function and equate it to 0. The solution to this equation gives us \\(x^*\\): \\[ f&#39;(x^*) = 0\\] Second-order condition: Compute the second derivative of the function and evaluate it at \\(x^*\\). If \\(f&#39;&#39;(x^*) &lt; 0\\), then \\(x^*\\) is a maxmizer. If \\(f&#39;&#39;(x^*) &gt; 0\\), then \\(x^*\\) is a minimizer. Example B.5 (Single variable optimization example) Consider a firm that produces a single good \\(q\\) and sells it at a price of $10 per unit. The cost of production is given by: \\[C(q)=2q+ 5+0.1q^2\\] At what level of output would profits be maximized? Solution. The profit of a firm is revenue minus cost: \\[\\pi(q)= R(q) -C(q)= 5q-2q-5-0.1q^2=2q-5-0.1q^2\\] Hence, we want to solve the following problem: \\[\\max_{q} \\pi(q)\\] The first order condition is given by: \\[\\pi&#39;(q)=0 \\Rightarrow 2-0.2q=0 \\rightarrow q^*=10 \\] The second order condition is given by: \\[\\pi&#39;&#39;(q)=-0.2&lt;0\\] Hence, \\(q^*=10\\) maximizes the profits. The maximum level of profits is given by \\(\\pi(q^*)=2\\times 10-5=0.1\\times 10=5\\). Note that the above process can be easily applied to multivariable functions. In that case there will be one first order condition for every control variable. Example B.6 (Multi-variable optimization example) Consider a two-variable function: \\[f(x_1,x_2)=2x_1x_2 + \\frac{100}{x_1} - 4x_2^2\\] Solve the following minimization problem: \\[\\min_{x_1,x_2} f(x_1,x_2)\\] Solution. Now we have two first order conditions: \\[f_{x_1}(x_1,x_2) = 0 \\Rightarrow 2x_2 -\\frac{100}{x_1^2}=0\\] \\[f_{x_2}(x_1,x_2) = 0 \\Rightarrow 2x_1 -8x_2=0\\] So we have two equations in two unknowns. You can show that \\(x_1*=5.84\\) and \\(x_2^*=1.46\\). The minimum of this function is given by \\(f(x_1^*,x_2^*)=2\\times 5.84*1.46+\\frac{100}{5.84} - 4\\times 1.46^2=25.65\\). Problems Exercise B.1 Compute the derivative of the following functions. \\(f(x)=2x^2\\) \\(f(x)=2x^2+ ln(x)\\) \\(f(x)=e^{ax}\\) \\(f(x)= (2x+x^2)^3\\) \\(f(x)= ln(5x+x^2)\\) \\(f(x)= \\displaystyle{\\frac{x+ln(x)}{x^3}}\\) Exercise B.2 Compute the second derivative of each function given in Exercise 2.1. Exercise B.3 Compute the partial derivative for each variable for the following functions: \\(f(x_1,x_2,x_3)=4x_1^3x_2-e^{x_3}x_1+3 x_2\\) \\(\\displaystyle{f(x_1,x_2)=\\frac{2x_1 +3x_2}{4x_1^3-7x_1x_2}}\\) \\(\\displaystyle{f(x, y)= ln(y^2)-ln(x)+2 ln\\left(\\frac{x}{y}\\right)}\\) \\(f(x,y)=2x^{0.4} y^{0.8}+2x\\) Exercise B.4 Solve the following optimization problems. In each case compute the maximizer(s) (or minimizer(s)) for the function as well as the optimum value of the function. \\(\\displaystyle{\\max_x f(x) = 3ln(x) - 0.5x+4}\\) \\(\\displaystyle{\\min_{x,y} f(x,y) = 2xy+\\frac{2000}{x}+\\frac{2000}{y}}\\) \\(\\displaystyle{\\max_x f(x) = ax^{0.5} - bx+4}\\) "],["review-of-probability-and-statistics.html", "C Review of Probability and Statistics C.1 Probability C.2 Random Variable C.3 Probability distribution C.4 Moments of a probability distribution function C.5 Useful probability distributions C.6 Joint Probability Distribution C.7 Measures of statistical association C.8 Sampling and Estimation C.9 Hypothesis testing Problems", " C Review of Probability and Statistics Given that all students must have taken a course in statistics before enrolling for this class, it is assumed that everyone in the class is comfortable with concepts such probability, expected value, measures of central tendency, hypothesis testing etc. In this chapter, I will provide a brief review of some concepts that are most pertinent for Econometrics. I strongly encourage that you read your lecture notes for Statistics if you find it difficult to follow the material presented in this chapter. C.1 Probability We begin with a brief review of probability thoery. To define probability we first need to develop an understanding of what we mean by experiment, sample space, and event in statistics. Definition C.1 (Experiment) An experiment is a process with an uncertain observable outcome. e.g. Toss of a coin can have two possible outcomes, heads or tails. Definition C.2 (Sample Space) The sample space is the set of all possible outcomes of an experiment. I will denote it by \\(S\\). If we toss a coin then \\(S=\\{Heads,Tails\\}\\). Definition C.3 (Event) An event is a subset of the sample space. I will denote it by \\(E\\). If we toss a coin and Heads shows up then \\(E={Heads}\\). Now, we can define probability, which is a function that assigns a numerical value to the chance of an event occuring among all possible events in the sample space. Definition C.4 (Probability) A function \\(P\\) is called a probability function if: For any given event, \\(E\\), \\(0 \\leq P(E)&lt; \\leq 1\\). Suppose there are N possible events in S, i.e., \\(S=\\{E_1, E_2, E_3,..,E_N\\}\\). Then, \\[P(E_1)+P(E_2)+P(E_3)+...+P(E_N)=1\\] Consider an event E. Then, \\[P(\\lnot E) = 1 -P(E) \\] If we have two disjoint events \\(A\\) and \\(B\\), then: \\(P(A \\cup B)= P(A) + P(B)\\) \\(P(A \\cap B)=0\\) If we have two non-disjoint events \\(A\\) and \\(B\\), then: \\(P(A \\cup B)= P(A) + P(B)-P(A \\cap B)\\) \\(P(A \\cap B)= P(A) \\times P(B|A)\\) If we have two independent events \\(A\\) and \\(B\\), then: \\[P(A \\cap B) = P(A) \\times P(B)\\] Bayes rule: \\[P(A|B)=\\frac{P(A) \\times P(B|A)}{P(B)}\\] where \\(\\displaystyle{P(B)= P(B|A)\\times P(A) + P(B|\\lnot A) \\times P(\\lnot A)}\\) One such probability function is: \\[\\begin{align} P(E) = \\frac{\\text{Number of outcomes in E}}{\\text{Number of outcomes in S}} \\end{align}\\] Example C.1 Consider a fair six-sided dice. The probability of obtaining an odd number if this dice is rolled once is given by 0.5. To see this, note that the event here is obtaining an odd number when a dice is rolled. Hence, \\(E=\\{1,3,5\\}\\). Also, \\(S=\\{1,2,3,4,5,6\\}\\). Using this, we get: \\[\\begin{equation} P(E)=\\frac{3}{6}=0.5 \\end{equation}\\] C.2 Random Variable One of the most important applications of statistics is to resolve the randomness that is inherent in most economic choices. For example, the outcome of your college major is a random variable with many possible values. Most economic variables can be thought of as random variables that have many possible values which are unknown until they are realized. We will begin by formally defining a random variable. Definition C.5 (Random Variable) A random variable is a numerical representation of outcomes of an experiment. For example, in the example of a toss of a coin, suppose you win $10 if heads shows and you lose $5 if tails shows. In this case, tossing the coin was the experiment, and winnings from this game is the random variable with two possible values: $10 and -$5. There are two types of random variables. Discrete random variable: takes finite number of values. e.g. GPA points earned in Econ 385. Continuous random variable: can take any value on the number line. e.g. GDP in the last quarter of 2019. C.3 Probability distribution By definition a random variable can take many possible values. In statistics a function that provides the probabilties of different realizations of a random varuable is called its probability distribution. C.3.1 Probability distribution of a discrete random variable For a discrete random variable the probability distribution is simply the list of all possible values this variable can and their corresponding probabilities. Let \\(X\\) be a discrete random variable with \\(n\\) possible values give by \\(\\{x_1,x_2,x_3,..,x_n\\}\\). Let \\(p_i\\) denotes that probability that \\(X=x_i\\). Then, the probability distribution function of this random variable is given by: X p(X) \\(x_1\\) \\(p_1\\) \\(x_2\\) \\(p_2\\) \\(x_3\\) \\(p_3\\) \\(\\vdots\\) \\(\\vdots\\) \\(x_n\\) \\(p_n\\) Example C.2 (Grade Distribution) A typical grade distribution is an example of a discrete random variable. Consider the following grade distribution: GPA Percent of Students \\(0\\) \\(10\\%\\) \\(1\\) \\(20\\%\\) \\(2\\) \\(40\\%\\) \\(3\\) \\(20\\%\\) \\(4\\) \\(10\\%\\) Note that every GPA point corresponds to a letter grade. From the perspective of the student, \\(X\\) is the random variable that is his letter grade, and the above distribution gives the probability of obtaining a particular letter grade. We can plot this simple probability distribution as follows: Figure C.1: Probability Distribution of Letter Grades We can use the probability distribution of a discrete random variable in two different ways. We can compute the probability of the random variable taking an exact value. This is known as the probability mass function (p.m.f) and is denoted by \\(f(x)\\): \\[f(x)=P(X=x)\\] For example, the probability of obtaining a letter grade of C or \\(P(X=2)\\) is 0.4 or 40%. We can also infer the probability that a discrete random variable will be less than or equal to a certain value by cumulatively adding the probabilities. Formally, we can compute the cumulative probability distribution (c.d.f) which is denoted by \\(F(x)\\): \\[F(x)=P(X\\leq X)\\] Going back to our grade distribution example, we can add the column of cumulative probabilities to obtain the \\(c.d.f\\): Grade Percent of Students \\(F(x)\\) \\(0\\) \\(10\\%\\) \\(10\\%\\) \\(1\\) \\(20\\%\\) \\(30\\%\\) \\(2\\) \\(40\\%\\) \\(70\\%\\) \\(3\\) \\(20\\%\\) \\(90\\%\\) \\(4\\) \\(10\\%\\) \\(100\\%\\) So for example, we can infer that the probability of obtaining the letter grade of C or lower i.e, \\(P(X\\leq 2)\\) is 0.7 or 70% which is obtained by adding the probabilities of obtaining letter grades of C, D, and F, respectively. Example C.3 (Bernoulli Random Variable) When a random variable is binary then we call it a Bernoulli random variable and its probability distrubition is called Bernoulli distribution. Consider a random variable that can only take two values, say, \\(0\\) or \\(1\\). It is common to think of these two values as coding a set criterion with \\(1\\) typically assigned if the criterion is met and \\(0\\) is assigned for failing to meet the criterion. For example, \\(X\\) could be whether you will get a job right after graduation. If you do then \\(X=1\\) and if you do not then \\(X=0\\). Let \\(p\\) denotes the probability that you will get a job. Then, the \\(p.m.f.\\) of the Bernoulli distribution is given by: \\[f(x)=\\begin{cases} p &amp; if \\ X=1\\\\ 1-p &amp; if \\ X=0 \\end{cases}\\] The \\(c.d.f\\) of the Bernoulli distribution is given by: \\[F(x)=\\begin{cases} 0 &amp; if \\quad X &lt; 0\\\\ 1-p &amp; if \\quad 0\\leq X&lt;1\\\\ p &amp; if \\quad X\\geq 1 \\end{cases}\\] C.3.2 Probability distribution of a continuous random variable In economics a large majority of variables of interest in theory are continous random variables. For example, the change in the price of Apple stock between two time periods is the return on Apple stock. If you are a trader in the NYSE then the stock return on Apple is a continuous random variable that can take any value on an interval. In such a case we cannot obtain the probability of the random variable taking an exact value. But we can only compute the probability that this random variable will fall in a given interval. So at best we can determine the probability that GDP growth for the US next quarter will be between say 1/% and 2%. This probability is obtained by computing the area under the probability density function (p.d.f). Let \\(X\\) denote a continuous random variable and \\(f(x)\\) denotes the p.d.f. Then, The probability that \\(X\\) takes value over the interval \\(\\{a,b\\}\\) is given by: \\[P(a\\leq X \\leq b)=\\int_a^bf(x) \\ dx\\] The c.d.f (the probability that \\(X\\leq x\\)) is given by: \\[F(x)=P(X\\leq x)=\\int_{-\\infty}^xf(x) \\ dx\\] Below I plot the empirical c.d.f for Apple’s stock return. Let \\(X\\) denotes this stock return. From Fig 3.2 we can infer that \\(P(X\\leq 0)=0.47\\) and \\(P(X\\leq 3)=0.95\\). Figure C.2: Empirical c.d.f of daily Apple Stock Return (2007-2019) Figure 3.3 below presents the p.d.f of the daily stock return that corresponds to the c.d.f plotted in Figure 3.2. Using this we can work the probability of stock returns falling in any given interval. For instance, the probability that Apple stock return will fall between 0 and 3% is the area under the p.d.f. between these two values. Figure 3.3 higlights this area and we can see that this probability is equal to 0.47. Figure C.3: Empirical p.d.f of daily Apple Stock Return (2007-2019) C.4 Moments of a probability distribution function The information contained in a probability distribution can be meaningfully summarized into measures that are called moments of that distribution. There are three moments we often use in economics: Center of the distribution: this is first moment of a given probability distribution and it gives us the most likely value of the random variable. It can be measured by mean, median or mode. We will use mean as a measure of the center of the distribution. Width of the distribution: this is the second moment and it measures the average distance from mean under a given probability distribution. We will use standard deviation as a measure of the width of the distribution. Shape of the distribution: this feature relates to role played by tail events , i.e., events that have very low probability of happening under a given probability distribution. Two relevant measures are Skewness and Kurtosis C.4.1 First moment of a probability distribution: Expected value What is the most likely value of a random variable? To answer that we often compute expected value of the random variable which gives us the center (or peak) of the underlying probability distribution. We will use E to denote expected value. So \\(E(X)\\) is the expected value of a random variable and we will use \\(\\mu_X\\) to denote the mean or average value of \\(X\\). Definition C.6 (Expected Value) Consider a discrete random variable \\(X\\) that can take \\(n\\) possible values and has the following probabilty distrubution: X p(X) \\(x_1\\) \\(p_1\\) \\(x_2\\) \\(p_2\\) \\(x_3\\) \\(p_3\\) \\(\\vdots\\) \\(\\vdots\\) \\(x_n\\) \\(p_n\\) Then, the expected value of \\(X\\) is given by: \\[E(X)= x_1 p_1 + x_2 p_2+...+ x_n p_n = \\sum_{i=1}^n y_ip_i\\] Hence, expected value is a probability-weighted average of all possible values of a random variable. ::: {.example #unnamed-chunk-57} Suppose you toss a fair coin and receive $10 if tails shows and receive 0 if heads shows. What is the expected value of the winnings from a single toss of this coin? ::: Solution. Let \\(X\\) denotes winnings from this game. It can take a value of $10 with a probability of 0.5 and 0 with a probability of half. So the expected value of X is: \\[E(X) = x_1 p_1+x_2 p_2=10\\times 0.5 + 0\\times 0.5=\\$5\\] Example C.4 Suppose you can invest $10,000 in a mutual fund after 1 year can earn a return of 10% with a probability of 0.1 or a return of 2% with a probability of 0.5 or a loss of 5% with a probability of 0.4. What is the expected return of investing $10,000 in this mutual fund? Solution. Let \\(X\\) denotes expected return in dollars. It can take 3 possible values: $1000 with a probability of 0.1, $200 with a probability of 0.5, and -$400 with a probability of 0.4 The expected value is given by: \\[E(X) = 1000\\times 0.1 + 200 \\times 0.5 - 400 \\times 0.4=\\$40 \\] As mentioned earlier, the first moment of the probability distribution (i.e., the expected value) gives us the most likely value of the random variable. How useful is this knowledge will depend on how far any realiaztion of the random variable can be from its expected value. The average distance from the average measures the width of the distribution. Wider the distribution, less useful is the knowledge of the expected value. C.4.2 Second moment of the distribution. To determine the width or dispersion of a probability distribution we use variance or standard deviation. The variance is the expected value of the squared deviation of each realization of the random variable from its average. We will denote the variance by \\(Var(X)\\) or \\(\\sigma^2_X\\): \\[Var(x)= \\sigma^2_X=E[(X-\\mu_x)^2]= (x_1-\\mu_X)^2 \\times p_1+(x_2-\\mu_X)^2 \\times p_2+...+ (x_n-\\mu_X)^2 \\times p_n =\\sum_{i=1}^n (x_i-\\mu_x)^2p_i\\] The standard deviation is simply the square root of the variance and is in the same units as the random variable. This allows easy comparison of the width and the center of the distribution. We will denote standard deviation by \\(\\sigma_X\\). Example C.5 Using the mutual fund example, the variance will measure riskiness of the investment. It is given by: \\[Var(X)=(1000-40)^2\\times 0.1 + (200-40)^2 \\times 0.5 - (400-40)^2 \\times 0.4=53120\\] Because variance is in square units and hence hard to interpret, we can easily compute the standard deviation as the square root of the variance: \\[\\sigma_X=\\sqrt{53120}=\\$230.47\\] Hence, even though the average return from this investment is $40, you can be $230 above or below this average. How much can we say about a random variable if we only know its mean and the standard deviation? That depends on the type of distribution the random variable follows. One of the most commonly used distribution in statistic is the Normal Distribution or the Gaussian Distribution. A random variable that follows normal distribution has a bell-shaped probability distribution with a given mean and standard deviation. One of the most useful features of such a distribution is that knowledge of the first two moments alone is sufficient to characterize the entire probability distribution. Figure 3.4 below shows a normal distribution with a mean of 5 and a standard deviation of 2. Figure C.4: Normal distribution with mean=5 and s.d.=2 Key features of the normal distribution that are very useful for us: 95% of the values fall within 1.96 times the standard deviation of the mean: \\[P(\\mu_X -1.96\\sigma_X \\leq X \\leq \\mu_X + 1.96\\sigma_X)=0.95\\] Tail events (low probability events) on either side of the mean are equally unlikely. Central limit theorem: The distribution of sample means calculated from repeated random sampling from a given population approaches a normal distribution as the sample size approaches \\(\\infty\\). C.4.3 Third and Fourth Moments: Skewness and Kurtosis In many cases, the distribution of a random variable is not normal and in such cases higher moments provide useful information about the shape of such probability distribution. The shape of the probability distribution plays an important role in many economic and financial applications. There are two measures of shape that are of interest: Skewness: this is the third moment of the distribution and it measures how skewed a distribution is. The formula for skewness is given by: \\[Skewness=\\frac{E[(X-\\mu_X)^3]}{\\sigma^2_X}\\] A normal distribution has a skweness of zero. There are two possible types of skewed distributions: A positively skewed distribution will have a long right tail implying lower probability of very large values relative to the mean. A neagtively skewed distribution will have a long left tail implying lower probablity of very small values relative to the mean. Figure 3.5 shows three probability distributions. For the left-skewed distribution, a longer left tail indicates low probability of obtaining values below the mean. Similarly, for the right-skewed distribution, a longer right tail indicates low probability of obtaining a value above the mean. For a normal distribution, the probability of obtaining a value above the mean is the same as the probability of obtaining a value below the mean. Figure C.5: Skewness of a Probablity distribution Kurtosis: this is the fourth moment of the distribution that captures the peakedness of the distribution (or thickness of the tail), i.e., how many observations fall on the extreme ends of a given probability distribution. As a result it tells us the role played by extreme values in driving the variance of a random variable. The formula is given by: \\[Kurtosis=\\frac{E[(X-\\mu_X)^4]}{\\sigma^4_X}\\] A normal distribution has a Kurtosis of 3. A value that is above or below 3 will give us excess or deficient Kurtosis. Two possiblities are: Leptokurtic distribution: has a Kurtosis value greater than three. Such a distribution will have fat tails compared to a normal distribution indicating greater area under the tails. Platykurtic distribution: has a Kurtosis value less than 3. Such a distribution will have thin tails compared to a normal distribution. Figure C.6: Kurtosis of a Probablity distribution Fig 3.6 shows three types of distribution based on their Kurtosis. The leptokurtic distribution has a Kurtosis value of greater than 3 and is more heavy-tailed or peaked than a norma distribution. C.5 Useful probability distributions Using the normal distribution we can derive a few useful probability distributions that are utilized in hypothesis testing. Standard Normal Distribution: A random variable that follows normal distribution with a mean of 0 and standard deviation of 1. Chi-square distribution: is obtained by squaring and adding indpendent standard normal distribution. For example, is \\(X\\) and \\(Y\\) are two standard normal random variables, then \\(Z=X^2 + Y^2\\) follows a Chi-square distribution with two degrees of freedom. F-distribution: is obtained by taking a ratio of two chi-square distribution. For example, if \\(X\\) is Chi-square with \\(v_1\\) degrees of freedom and \\(Y\\) is a Chi-quare with \\(v_2\\) degress of freedom, then \\(\\displaystyle{Z=\\frac{X}{Y}}\\) follows F-distribution with \\(v_1\\) and \\(v_2\\) degrees of freddom. t-distribution: Student’s t-distribution is obtained by taking a ratio of a standard normal and the square root of a Chi-square random variable. For example, if \\(X\\) is a standard normal and \\(Y\\) is a Chi-square with \\(m\\) degrees of freedom, then \\(Z=\\displaystyle\\frac{X}{\\sqrt{Y/m}}\\) follows t-distribution with \\(m\\) degrees of freedom. t-distribution has fatter tails when compared to normal. C.6 Joint Probability Distribution In economics, often we are interested in the relationship between a pair of variables. For example, how does interest rate affects consumption spending? Or how does education affect wages? In order to statistically answer such questions, we need to understand the meaning of statistical relationship between two or more variables. One way to move forward is to assume that both variables jointly follow some given probability distribution which can be used to infer their relationship with one another. For simplicity, I will use the discrete random variables case but the concepts covered can be easily extended for the continuous random variables case. Let \\(X\\) and \\(Y\\) denote two random variables of interest, both from a common probablity distribution denoted by \\(F(x,y)\\). This function gives us the probability that \\(X\\) and \\(Y\\) simultaneously take on certain values: \\[F(x,y)=P(X=x, Y=y)\\] Example C.6 Suppose you are an investment banker and you are considering investment into two assets: a stock listed in NYSE (\\(X\\)) and a cotton futures (\\(Y\\)) listed in Chicago Mercantile Exchange. Suppose \\(X\\) can take three possible values: 2/%, 3/%, or 4/%. Similarly \\(Y\\) can take three possible values given by 6/%,4/%, or 1/%. The value will depend on the state of the economy. Suppose there are three possiblities for the economy next year: boom, expansion, and status quo. The joint probability distribution for \\(X\\) and \\(Y\\) is given by: State of Economy X/Y 6 4 1 Total Recession 2 0.15 0.2 0.1 0.45 Expansion 3 0.1 0.1 0.2 0.4 Status quo 4 0.1 0.05 0 0.15 Total 0.35 0.35 0.3 1 So in a recession, the probability of obtaining a return of 2/% on the stock and 6/% return on the commodity, i.e, \\(P(X=2,Y=6)\\), is 0.15. Using the above joint probabity distribution of \\(X\\) and \\(Y\\) we can compute two related distributions for each random variable: Marginal distribution: For each random variable, we can extract its own probability distribution from the joint probability distribution. This is done by simply adding probabilities of all possible outcomes for a particular value of a given random variable. For example, the marginal distribution for \\(X\\) is given by: \\[P(X=x)=\\sum_{i=1}^nP(X=x, Y=y_i)\\] Hence, in our example, the marginal distribution of \\(X\\) is given by the last column, called Total in the table. For \\(Y\\) it is the row called Total. We can use the marginal distribution to compute the unconditional expected value of each random variable. For example, \\[E(Y) = 6 \\times P(Y=6) + 4 \\times P(Y=4)+1 \\times P(Y=1)=3.8\\] Conditional distribution: For each random variable, we can also compute its probability distribution conditional on the other variable taking on a specific value. For exampl,e the conditional distribution of \\(Y\\) given that \\(X=x\\) is given by: \\[ P(Y=y|X=x) =\\frac{P(X=x,Y=y)}{P(X=x)}\\] From our example, what is the probability of obtaining 4% return on commodity under status quo if the return on the stock is 4%? So here we are interested in finding out: \\[ P(Y=4|X=4) =\\frac{P(X=4,Y=4)}{P(X=4)}= \\frac{0.05}{0.15}=0.33\\] To see this, note that from the table that P(X=4, Y=4) under status quo is given by 0.05. Also, using the definition of marginal distribution, we know that P(X=4)=0.15. The conditional distribution of a random variable is a first step toward understanding the statistical relationship between two or more random variables. Just like the probability distribution of a random variable has a mean and a variance, the conditional distribution can similarly be characterized by conditional mean and conditional variance: Conditional expected value (\\(E(Y|X)\\)): Using the conditional distribution we can now compute the expected value of a random variable, given the value of another random variable. This is denoted by \\(E(Y|X)\\) and can be computed as follows: \\[E(Y|X)=y_1 \\times P(Y=y_1|X=x) + y_2 \\times P(Y=y_2|X=x)+...+ y_n \\times P(Y=y_n|X=x)\\] As we can see, this expected value will be a function of \\(X\\). Depending on the realization of \\(X\\) our expectation of \\(Y\\) would change. In economics, we can imagine many such examples. For example, given our education level our expected wage will change. Similarly, given expenditure on advertising, expected sales will change. Hence, conditional expected value goes a long way in establishing statistical relationship between economic variables. Going back to our example, let us compute the expected return on the commodity \\(Y\\) conditional on the information that the return on \\(X\\) is 3%: \\[E(Y|X) = 6 \\times P(Y=6|X=3) + 4 \\times P(Y=4|X=3) + 1 \\times P(Y=1|X=3)\\] Here, \\(P(Y=6|X=3)= \\displaystyle\\frac{0.1}{0.4}=0.25\\), \\(P(Y=4|X=3)= \\displaystyle\\frac{0.1}{0.4}=0.25\\) and \\(P(Y=1|X=3)= \\displaystyle\\frac{0.1}{0.2}=0.5\\). Hence, \\(E(Y|X=3)=3\\%\\). Contrast this to the uncondtional expected value of \\(Y\\) of 3.8% we computed earlier. Conditional variance (\\(Var(Y|X)\\)): Now even the variance of a random variable can be affected by another random variable. Here, we are interested in deviations of the random variable from its conditional mean: \\[\\begin{align} Var(Y|X) = (y_1 -E(Y|X))^2 \\times P(Y=y_1|X=x) + (y_2 -E(Y|X))^2\\times P(Y=y_2|X=x)+...\\\\ \\nonumber + (y_n -E(Y|X))^2 \\times P(Y=y_n|X=x) \\end{align}\\] C.7 Measures of statistical association We can now define two measures of statistical relationship. The first one is called Covariance and the second is Correlation. Covariance is a measure of association that captures how deviations from mean of one random variable are related to deviations of another random variable to its respective mean. For example, if your hours of study are above average, then what is your test score relative to average? Formally, \\[Cov(X,Y) = E(Y-\\mu_Y)(Y-\\mu_X)\\] If the above number is positive, then there is a positive relationship between \\(X\\) and \\(Y\\). That is, when \\(X\\) is above its mean then \\(Y\\) is also above its mean. If the number is negative then there is a negative relationship between \\(X\\) and \\(Y\\). Note that because \\(X\\) and \\(Y\\) are often in different units of measurement, the number we obtain for covariance has no meaning or implication for the strength of the relationship between two variables. Correlation: is the value of covariance that is standardized by dividing this number by standard deviations of each random variable: \\[Cor(X,Y) = \\frac{Cov(X,Y)}{\\sigma_X \\times \\sigma_Y }\\] This number is unit free and falls between \\(-1\\) and \\(1\\). The sign of the correlation tell us about the direction of the relationship whereas the value of the correlation gives information about the strength of the relationship. A higher absolute value indicates stronger statistical relationship between two variables. C.7.1 Rules of expectation and variances Here are some useful rules that are useful for our purpose: \\(E(\\beta)=\\beta\\) and \\(Var(\\beta)=0\\) where \\(\\beta\\) denotes a constant. \\(E(\\beta X)= \\beta E(X)\\) and \\(Var(\\beta X)= \\beta^2 Var(X)\\) where \\(\\beta\\) denotes a constant. Consider two random variables \\(X\\) and \\(Y\\), and let \\(a\\) and \\(b\\) denotes two constants. Then, 3.1. \\(E(aX+bY)=aE(X)+bE(Y)\\) 3.2. \\(E(aX-bY)=aE(X)-bE(Y)\\) 3.3. \\(Var(aX+bY)=a^2 Var(X)+b^2 Var(Y)+2abCor(X,Y)\\sqrt{Var(X)}\\sqrt{Var(Y)}\\) 3.4. \\(Var(aX-bY)=a^ 2Var(X)+b^2 Var(Y)-2abCor(X,Y)\\sqrt{Var(X)}\\sqrt{Var(Y)}\\) C.8 Sampling and Estimation An important distinction in statistics is between the population of interest and a sample of this population that we usually work with. Due to feasibility of data collection and cost both in terms of time and money, most real world analysis is based on a sample that is a subset of the population of interes. For example, to study how business major affects starting salary, the relevant population is all business majors from a graduating class in the U.S. in a given year. In practice however, we will most likely use a sample of this population, for example all business majors from JMU. How useful an analysis based on a sample is depends on how representative the chosen sample is of the entire population. For our purpose, lack of data on population means that the true probablity distribution of a random variable is unknown and hence the true values of mean, variance, covarinace etc are also unknown to us. Statistics provides a way of using samples to estimate relevant moments of the probability distribution. The approach we take is as follows: Consider the unknown moments of the true probability distribution as ** population parameters** that we would like to estimate. Draw a representative sample from the population. In simple random sampling we draw \\(n\\) obeservations at random so that each member of the population is equally likely to be included in the sample. We can also use other complex sampling schemes where certain groups of population are more likely to be selected in the sample than others. Two examples: Suppose we are interested in finding out starting salary of CoB majors at JMU. The population will be every graduating student for a given year. However, we may work with a sample of students, where we draw randomly from every major ensuring that all graduating students have equal probability of selection. Suppose we are interested in finding out usage of food stamps in Harrisonburg area. The population of interest will be all residents of Harrisonburg who use food stample. However, we may work with a sample where a certain demographic group is more likely to be part of the sample (and hence is oversampled). Use the sample to compute sample estimates for each population parameter of interest. For example for expected value we can use sample mean as an estimator, for variance we can use sample variance as an estimator and so on. There are following key differences between population parameters and their sample estimates: Population parameters are true but unknown values that we are interested in measuring. In contrast, sample estimates can be computed using our sample data. Population parameters are fixed whereas sample estimates change as we change our sample. For example, if we compute mean starting salary of business majors from JMU we get one number. If use data from UVA we get another number for mean starting salary. Because different samples give us different sample estimates for the same population parameter, we need to ensure that our sample estimator from one sample data is reliable. Sampling distribution: Hypothetically, we can draw many samples from the same population and compute sample estimate for each sample. This will give us a distribution of for the sample estimate which will have its own mean and variance. We can use this sampling distribution to: Establish reliablity of the sample estimator. Specifically any sample estimator should be unbiased and efficient. More on this in the next section. Statsitically test hypotheses about the true population parameter ### Unbiasedness and efficiency Let \\(\\theta\\) denote a population parameter of interest. For example, it can be the mean of the random variable of interest. Let \\(\\widehat{\\theta}\\) denotes a sample estimator of \\(\\theta\\) that can be computed using sample data. Then, \\(\\widehat{\\theta}\\) is an unbiased estimator of \\(\\theta\\) if: \\[E(\\widehat{\\theta})=\\theta\\] The idea here is that if we repeatedly draw a sample from the same population and compute \\(\\widehat{\\theta}\\) for each such sample, the average of these estimators must be equal to the true population parameter for unbiasedness. In otherwords, the center of the sampling distribution is at the true population parameter value. We can now define bias of an estimator as follows: \\[Bias(\\widehat{\\theta}) = E(\\widehat{\\theta})-\\theta\\] For an unbiased estimator, \\(Bias(\\widehat{\\theta})=0\\). If \\(Bias(\\widehat{\\theta})&gt;0\\) then we have an over-estimate and if \\(Bias(\\widehat{\\theta})&lt;0\\) then we have an under-estimate. Efficiency: Unbiasedness ensure that the average of sample estimator is equal to the true population parameter. But if the standard deviation of the sample estimator is too high, then knowing that the average is close to the true value is not very useful. In statistics, we call such an estimator unbiased but imprecise or inefficient. To be efficient the standard deviation (or variance) of the sample estimator should be as small as possible. Between two unbiased estimators, a more efficient estimator will have a lower variance. Example C.7 Suppose we have a random sample with \\(n\\) observations: \\(\\{x_1,x_2,...,x_n\\}\\) drawn from a population with a mean of \\(\\mu_x\\). Sample mean is defined as: \\[\\overline{X}=\\frac{\\sum_{i=1}^N x_i}{N}\\] The expected value of the sample mean is given by: \\[E(\\overline{X})=E\\left(\\frac{\\sum_{i=1}^N x_i}{N}\\right)\\] Using properties of the expected value, we get: \\[E(\\overline{X})=\\frac{E(x_1)+E(x_2)+...+ E(x_N)}{N}\\] Note that because this is a random sample from the same population with a mean of \\(mu_x\\), we get \\(E(x_1)=E(x_2)=..=E(x_n)=\\mu_x\\). Hence, \\[E(\\overline{X})=\\frac{\\overbrace{\\mu_x+\\mu_x+...+\\mu_x}^{\\text{N terms}} }{N}=\\mu_x\\] As a result the sample mean is an unbiased estimator of the population mean. However, there are many other possible unbiased estimators of the population mean. We can show that among all other unbiased estimator of the population mean, sample mean has the lowest variance and hence is most efficient estimator as well. Definition C.7 (Best Unbiased Estimator (BUE)) Let \\(\\theta\\) denote a population parameter of interest. Then, an sample estimator denoted by \\(\\hat{\\theta}\\) is the of \\(\\theta\\) if the following two conditions are satisfied: \\(\\hat{theta}\\) is an unbiased estimator, i.e., \\(E(\\hat{\\theta})=\\theta\\). In this case the sampling distribution is centered at the true value of the parameter. \\(\\hat{\\theta}\\) is an efficient estimator, i.e., \\(Var(\\hat{\\theta})&lt; Var(\\hat{\\theta_A})\\) for any other unbiased estimator denoted by \\(\\hat{\\theta_A}\\). In this case the width of the sampling distribution around the mean is smallest possible. C.9 Hypothesis testing An important part of any statistical analysis is testing various hypotheses about population parameters of interest. This is known as and here we use the sampling distribution of the estimator to formally test whether the corresponding population of interest takes a certain value or not. This is important because even with an best unbiased estimator we do not know the true value of the population parameter of interest. In this section we will look at two types of hypotheses testing procedures that are most relevant for Econometrics. The procedure for any statistical test more or less consists of the following steps: Formulate a hypothesis of interest. This typically manifest as a restriction on the value of a population parameter (or a combination of multiple parameters). The goal is to test whether there is support for this restriction in our sample or not. There are two types of hypotheses that we must formulate: 1.1. Null Hypothesis (\\(H_0\\)): A null hypothesis is the statement about the population parameter we assume to be true until we find evidence otherwise. For example, we can test whether the population mean of starting salary for CoB majors is $60,000. Formally, \\[H_0: \\mu_X = 60,000\\] Note that the null hypothesis statement is an equality condition. 1.2. Alternative Hypothesis (\\(H_A\\)): This is the logical counterpart of the null hypothesis and here we specify. There are two types of alternative hypothesis we can specify: Two-sided alternative: Here, the alternative hypothesis statement allows for both sides of the inequality. Going back to our example of starting salary, a two-sided alternative will be: \\[H_A: \\mu_X \\neq 60,000\\] One-sided alternative: Here, we either use a greater or less than sign for the alternative hypothesis. So for example, we can speficy the following one-sided alternative: \\[H_A: \\mu_X &gt; 60,000\\] Compute the relevant test statistic that is a function of the sample data. The formula for the test statistic is a function of the sample estimator and the value of the population parameter(s) we assumed in the null hypothesis. The test statistic is assumed to follow a certain probability distribution under the assumption that the null hypothesis is correct. The tails of this distribution summarizes values of the test statistic that are less likely to realize. Such a value of the test statistic provides us a threshold level, called the , beyond which the test statistic values are less likely to realize if our hypothesis is true. The decision rule for rejecting or not rejecting the null hypothesis is based on the comparison between the computed test statistic and the associated critical value. Note that there is always a measure of uncertainty in any hypothesis testing: we may end up making a wrong decision. There are two types of errors we can make here: Type I error: here we reject \\(H_0\\) when it is true. The probability of this type of error is denoted by \\(\\alpha\\) and is called the level of significance of a test. Type II error: here we do reject \\(H_0\\) when it is false. The probability of this type of error is related to the power of a test. Ideally we would like to minimize the probability of both types of errors but we cannot do that because reducing one error comes at the cost of increasing the other. As a result, we first specificy an acceptable level of significance (type one error probability) and then try to minimize the probability of type two error (or maximize the power of the test). It is common to assume a level of signficance of 5% or \\(\\alpha=0.05\\). So here we are willing to tolerate a 5% chance of falsely rejecting the null hypothesis. Once we have fixed the level of significance, we can use the distribution table of the test-statistic to obtain the corresponding critical value(s). C.9.1 Testing a restriction on a single population parameter Here our goal is to develop tests for testing statements about a single population parameter of interest. So for example, we can either test a statement about a population mean or a population variance. Example C.8 (t-test for population mean) Suppose you are interested in measuring mean hourly wage of males aged 25-35. Accordingly, we collect a sample of 100 workers from the population of male in this age group with a mean of \\(\\mu_X\\) and a standard deviation of \\(\\sigma_X\\). The sample mean is \\(\\hat{\\mu}_X=\\$25\\) and the sample standard deviation is \\(\\hat{\\sigma}_X=\\$7\\). Now, suppose we want to test the following hypothesis: \\[H_0: \\mu_X=27\\] \\[H_0: \\mu_X \\neq 27\\] The test statistic is given by the t-statistic where: \\[t=\\frac{\\hat{\\mu}_X-\\mu_X}{s.e.(\\hat{\\mu}_X)} \\] where \\(s.e.(\\hat{\\mu}_X)=\\displaystyle \\frac{\\hat{\\sigma}_X}{\\sqrt{N}}\\) is the standard error of sample mean and N denotes sample size. If the null hypothesis is true, this test statistic follows t-distribution with N-1 degrees of freedom. Using the t-distribution table we can then compute the critical value which is used in formulating the decision rule. Let \\(t_c\\) denote this critical value from the distribution table. Then, \\[|t|&gt;t_c \\quad \\Rightarrow \\text{reject $H_0$} \\] \\[|t|&lt;t_c \\quad \\Rightarrow \\text{do not reject $H_0$} \\] In our example, \\(N=100\\), and \\[t=\\frac{25-27}{\\frac{7}{\\sqrt{100}}}=-2.86\\] The degrees of freedom is \\(N-1=99\\) and at 5% level of significance the critical value from the t-distribution table is \\(t_c=1.98\\). Because |t| is larger than the critical value, we reject the null hypothesis. Hence, we find evidence against the statement that the mean hourly wage of male workers is $25. Note that an alternative way of testing hypothesis like this is to use the p-value rule. The underlying idea is to find out the largest significance level at which we will fail to reject the null hypothesis. This value is called the p-value and most statistical softwares report this value. The decision-rule is then greatly simplified: \\[\\text{If p-value is less than the chosen level of significance (value of $\\alpha$) then reject $H_0$.}\\] In our case, the p-value is 0.0053. Because we chose \\(\\alpha=0.05\\), according to the p-value rule we will reject the null hypothesis. Example C.9 (Chi-square test for population variance) Using the same example, we also test a statement about the population variance. Suppose we want to test whether the variance of the hourly wage is 52. \\[H_0: \\sigma^2_X=52\\] \\[H_0: \\sigma^2_X &gt;52 \\] The test statistic is given by the V-statistic where: \\[V=\\frac{(N-1)\\times \\hat{\\sigma^2_X}}{\\sigma^2_X}\\] If the null hypothesis is true, this test statistic follows Chi-square distribution with N-1 degrees of freedom. Using the distribution table we can then compute the critical value which is used in formulating the decision rule. Let \\(V_c\\) denote this critical value from the distribution table. Then, \\[V&gt;V_c \\quad \\Rightarrow \\text{reject $H_0$} \\] \\[V&lt;V_c \\quad \\Rightarrow \\text{do not reject $H_0$} \\] In our example, \\[V=\\frac{(100-1)\\times 7^2}{52}=93.29\\] The degrees of freedom is \\(N-1=99\\) and at 5% level of significance the critical value from the Chi-square distribution table is \\(V_c=43.77\\). Because \\(V\\) is larger than the critical value, we reject the null hypothesis. Hence, we find evidence against the statement that the variance of the hourly wage of male workers is 52. C.9.2 Testing a restriction on multiple population parameter Often we are interested in testing a restriction that is a linear combination of two or more population means. Similarly, we maybe interested in comparing the variance of two different populations. In such cases we need to develop statistical tests that allow for comparison between parameters of different populations with given means and variances. Example C.10 (t-test for comparing population mean of two populations) Suppose you are interested in comparing mean weekly hours studied by Econ majors (X) and non-Econ majors in the college of business. For this purpose, you collect a sample of 25 econ majors and a sample of 30 non-econ majors. The sample mean of weekly hours studied by econ majors is 10 hours with a standard deviation of 4 hours. The sample mean of weekly hours studied by non-econ majors is 8 hours with a standard deviation of 2 hours. Also suppose that the covariance between weekly hours studied by econ and non-econ majors is 0.12. Test whether mean weekly hours studied by econ majors is more than the mean weekly hours studied by non-Econ majors. Let \\(X\\) denote hours studied, \\(N_X\\) denotes sample size, \\(\\hat{\\mu}_X\\), and \\(\\hat{\\sigma}_X\\) denote sample mean and standard deviation, respectively for econ majors. Similarly, let \\(Y\\) denote hours studied, \\(N_Y\\) denotes sample size, \\(\\hat{\\mu}_Y\\), and \\(\\hat{\\sigma}_Y\\) denote sample mean and standard deviation, respectively for non-econ majors. The first step, as usual, is to formulate the null and the alternative hypotheses: \\[H_0= \\mu_X - \\mu_Y = 0\\] \\[H_A= \\mu_X - \\mu_Y &gt; 0\\] The next step is to compute the relevant test statistic, which in this case is the t-ratio given by: \\[t= \\frac{(\\hat{\\mu_X}-\\hat{\\mu_Y})-0}{s.e.(\\hat{\\mu_X}-\\hat{\\mu_Y})}\\] Using the properties of variance, we get: \\[s.e.(\\hat{\\mu_X}-\\hat{\\mu_Y})=\\sqrt{Var(\\hat{\\mu_X})+Var(\\hat{\\mu_Y})-2 \\times Cor(X,Y)\\times s.e.(\\hat{\\mu_X}) \\times s.e.(\\hat{\\mu_Y})}=0.84\\] So, \\(t=\\displaystyle \\frac{10-8}{0.84}=2.38\\) The sample size here is \\(N_X+N_Y=55\\). Using 5% level of significance and degrees of freedom of 53, the critical value from the t-distribution table for the one-sided alternative is 1.67. Because the |t| is more than 1.67, we reject the null hypothesis. We find evidence for econ majors studying more on average than non-econ majors in our sample. Example C.11 (F-test for comparing population variance of two populations) Often we may be interested in comparing the variability between two populations. Using our previous example, we may want to test whether variability in hours studied is bigger for econ majors versus non-econ majors. This can be tested by comparing the ratio of two variances against the value of 1. As before, we start by formulating the null and the alternative hypotheses: \\[H_0: \\sigma^2_X/sigma^2_Y = 1\\] \\[H_0: \\sigma^2_X/sigma^2_Y &gt; 1\\] The corresponding test statistic is the F-ratio: \\[F = \\frac{\\hat{\\sigma^2_X}}{\\hat{\\sigma^2_Y}}=\\frac{4^2}{2^2}=4\\] If the null hypothesis is true, the above test statistic follows F-distribution with \\(N_x-1\\) degrees of freedom for the numerator and \\(N_y-1\\) degrees of freedom for the denominator. At 5% level of significance, the critical value for \\(\\nu_1=24\\) and \\(\\nu_2=29\\) from the F-distribution table is 3. Because the computed F-ratio exceeds the critical value we reject the null hypothesis. C.9.3 Confidence interval and Hypothesis testing One issue with using a sample to estimate population parameters is that by definition a sample estimator will be different for different samples. Thus, sample mean provides no information about how close this estimator is to the true population mean. This uncertainty in estimation can be summarized by computing the standard deviation, with higher value of standar deviation indicating greater uncertainty about the true population parameter. A better measure of this uncertainty is the confidence interval. Definition C.8 (Confidence Interval) Suppose we draw a random sample \\(\\{x_1, x_2,...,x_N\\}\\) from a normally distributed population with mean of \\(\\mu_X\\) and a standard deviation of \\(\\sigma_X\\). Let \\(\\hat{\\mu_X}\\) denotes the sample mean and \\(\\hat{\\sigma_X}\\) denotes sample standard deviation. Then, the 95% confidence interval for \\(\\hat{\\mu_X}\\) is given by: \\[\\left[\\hat{\\mu_X}-t_{c,2-sided} \\times \\frac{\\hat{\\sigma_X}}{\\sqrt{N}},\\hat{\\mu_X}+t_{c,2-sided} \\times \\frac{\\hat{\\sigma_X}}{\\sqrt{N}} \\right]\\] where \\(t_{c,2-sided}\\) is the critical value that can be obtained from the t-distribution table for a given level of signicance and degrees of freedom. For example, for a 95% confidence interval we will use 5% level of significance. Example C.12 Suppose N=20, \\(\\hat{\\mu_X}=5\\), and \\(\\hat{\\sigma_X}=2\\). Then, the 95% confidence interval for \\(\\hat{\\mu_X}\\) is given by: \\[\\left[5-2.093 \\times \\frac{2}{\\sqrt{20}}, 5+2.093 \\times \\frac{2}{\\sqrt{20}} \\right]=[4.06,5.94]\\] Hence, before we drew our sample from the population, there is a 95% chance that the true population parameter (\\(\\mu_X\\)) will fall between 4.12 and 5.94. Note that: Wider the confidence interval, greater is the uncertainty about the true value of the population mean. We can use the confidence interval to conduct hypothesis testing for a two-sided alternative hypothesis. If the null hypothesis value does not fall in the confidence interval, then with 95% confidence (or at 5% level of significance) we can reject the null hypothesis. For example, consider the following test: \\[H_0: \\mu_X=3.8\\] \\[H_A: \\mu_X\\neq 3.8\\] Because 3.8 is not in the confidence interval we will reject the null hypothesis at 5% level of significance. Note that we will obtain the same conclusion if we were to compute the t-ratio and compare it with the corresponding critical value from the t-distribution table. Problems Exercise C.1 Suppose you roll a 6-sided fair dice. If an odd number shows you win $10. If either 2 or 4 shows you lose $5. If 6 shows, you neither gain nor lose anything. Denote the winnings from this game as \\(X\\). Tabulate the probability distribiution of the random variable \\(X\\). Compute the expected value and the standard deviation for \\(X\\). Exercise C.2 Consider a population with a mean of \\(\\mu\\) and variance of \\(\\sigma^2\\). Suppose you draw a random sample \\(X_1, X_2,..,X_N\\). Show that \\(\\hat{\\mu_A}=0.25\\times X_1 +0.25\\times X_3+ 0.25 \\times X_8 + 0.25 X_20\\) is an unbiased estimator of \\(\\mu\\). Show that \\(\\hat{\\mu_B}=0.1\\times X_1 +0.1\\times X_3+ 0.5 \\times X_8+0.3 \\times X_11\\) is an unbiased estimator of \\(\\mu\\). Now compute variance of \\(\\hat{\\mu_A}\\) and \\(\\hat{\\mu_B}\\). Which one is more efficient estimator of \\(\\mu\\). Exercise C.3 Suppose you collect a random sample of 100 observations and find that sample mean is -25 and sample variance is 350. Test whether the population mean is -22. Test whether the population variance is 400. Exercise C.4 Suppose you are interested in comparing performance of two different mutual funds, \\(X\\) and \\(Y\\). Let \\(\\mu_X\\) and \\(mu_Y\\) denote unknown population mean returns on investment in \\(X\\) and \\(Y\\), respectively. Suppose you collect past 20 months data for both mutual funds and find that sample mean for fund \\(X\\) is 2% with a standard deviation of 0.5%. In contrast, the sample mean for fund \\(Y\\) is 5% with a standard deviation of 2%. Suppose that the correlation between returns on these two funds is 0.2. Test whether mean return on \\(Y\\) is greater than that on \\(X\\). Test whether variance of \\(Y\\) is greater than that of \\(X\\). Compute the 95% confidence interval for \\(\\hat{\\mu_X}\\). Using the confidence interval, what can you say about the population mean return for fund \\(X\\)? "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
